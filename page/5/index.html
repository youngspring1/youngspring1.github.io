<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>è¡Œè¡Œé‡è¡Œè¡Œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ä¸æƒ³å½“å»ºç­‘å¸ˆçš„ç¨‹åºå‘˜ä¸æ˜¯ä¼˜ç§€çš„è¿åŠ¨å‘˜">
<meta property="og:type" content="website">
<meta property="og:title" content="è¡Œè¡Œé‡è¡Œè¡Œ">
<meta property="og:url" content="https://youngspring1.github.io/page/5/index.html">
<meta property="og:site_name" content="è¡Œè¡Œé‡è¡Œè¡Œ">
<meta property="og:description" content="ä¸æƒ³å½“å»ºç­‘å¸ˆçš„ç¨‹åºå‘˜ä¸æ˜¯ä¼˜ç§€çš„è¿åŠ¨å‘˜">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è¡Œè¡Œé‡è¡Œè¡Œ">
<meta name="twitter:description" content="ä¸æƒ³å½“å»ºç­‘å¸ˆçš„ç¨‹åºå‘˜ä¸æ˜¯ä¼˜ç§€çš„è¿åŠ¨å‘˜">
  
    <link rel="alternate" href="/atom.xml" title="è¡Œè¡Œé‡è¡Œè¡Œ" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">è¡Œè¡Œé‡è¡Œè¡Œ</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Zoeken"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://youngspring1.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2016-05-10-R05" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-05-10-R05/" class="article-date">
  <time datetime="2016-05-14T07:19:28.000Z" itemprop="datePublished">2016-05-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/æ•°æ®åˆ†æç¬”è®°/">æ•°æ®åˆ†æç¬”è®°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-05-10-R05/">MIT:The Analytics Edge ç¬”è®°05ï¼æ–‡æœ¬åˆ†æ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MITè¯¾ç¨‹ <a href="https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info" target="_blank" rel="external">15.071x The Analytics Edge</a> ç¬¬äº”å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚</p>
<hr>
<h2 id="Text-Analytics"><a href="#Text-Analytics" class="headerlink" title="Text Analytics"></a>Text Analytics</h2><p>ç¬¬äº”å•å…ƒçš„ä¸»é¢˜æ˜¯æ–‡æœ¬åˆ†æã€‚</p>
<h3 id="1-ç†è®º"><a href="#1-ç†è®º" class="headerlink" title="1.ç†è®º"></a>1.ç†è®º</h3><h4 id="Bag-of-Words"><a href="#Bag-of-Words" class="headerlink" title="Bag of Words"></a>Bag of Words</h4><p>ä¸€æ®µæ–‡æœ¬ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å¤šä¸ªå•è¯çš„é›†åˆã€‚<br>ç»Ÿè®¡è¿™äº›å•è¯çš„ç‰¹å¾ï¼Œå¯ä»¥å½’çº³æ–‡æœ¬çš„å€¾å‘ã€‚   </p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ–‡æœ¬è¿›è¡Œä¸‹é¢è¿™å‡ æ­¥é¢„å¤„ç†ï¼š   </p>
<ol>
<li>clean up irregularities(ç»Ÿä¸€å¤§å°å†™)</li>
<li>remove punctuations(å»æ‰æ ‡ç‚¹æˆ–è€…ç‰¹æ®Šç¬¦å·)</li>
<li>remove stop words(å»æ‰theï¼whoï¼isï¼doè¿™äº›å•è¯)</li>
<li>stemming(è·å–è¯å¹²ï¼Œä¹Ÿå°±æ˜¯å»é™¤åŠ¨è¯å˜å½¢ï¼Œæ¯”å¦‚agruedï¼Œagruesï¼Œagruingï¼Œéƒ½å˜æˆagru)</li>
</ol>
<p>ç„¶åï¼Œæˆ‘ä»¬ç»Ÿè®¡æ–‡æœ¬ä¸­å‰©ä¸‹è¿™äº›å•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œç”Ÿæˆä¸€ä¸ªçŸ©é˜µï¼Œç±»ä¼¼è¿™æ ·çš„æ ¼å¼ï¼š</p>
<table>
<thead>
<tr>
<th>text num</th>
<th>word1</th>
<th>word2</th>
<th>word3</th>
<th>â€¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>text1</td>
<td>2</td>
<td>5</td>
<td>0</td>
<td>â€¦</td>
</tr>
<tr>
<td>text2</td>
<td>0</td>
<td>3</td>
<td>4</td>
<td>â€¦</td>
</tr>
<tr>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
</tbody>
</table>
<p>åœ¨å®é™…ä¸­ï¼Œç”Ÿæˆçš„çŸ©é˜µæ˜¯ä¸ªç¨€ç–çŸ©é˜µï¼ˆæœ‰å¾ˆå¤š0ï¼‰ï¼Œæˆ‘ä»¬åªé€‰å–å‡ºç°æ¬¡æ•°æ¯”è¾ƒå¤šçš„ï¼Œå¿½ç•¥é‚£äº›ä¸å¸¸è§çš„å•è¯ã€‚<br>æ¯”å¦‚é€‰å–è‡³å°‘å‡ºç°è¿‡20æ¬¡çš„å•è¯ï¼Œå…¶ä»–çš„å¿½ç•¥ã€‚<br>è¿™æ ·çš„çŸ©é˜µï¼Œæ¯åˆ—çš„åˆ—åå°±æ˜¯è‡ªå˜é‡ï¼ŒçŸ©é˜µçš„å€¼å°±ç”¨åšè‡ªå˜é‡çš„å–å€¼ã€‚   </p>
<p>æœ€åï¼Œæ‰‹åŠ¨æ·»åŠ ä¸€åˆ—ï¼Œä½œä¸ºå› å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®è¿™äº›å•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œé¢„æµ‹å› å˜é‡çš„å–å€¼äº†ã€‚<br>æ‰€ä»¥ï¼Œè¿™ä¸€åˆ—å› å˜é‡çš„æ•°å€¼å¦‚ä½•å®šä¹‰ï¼Œå®ƒçš„å®é™…æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Œå…¶å®æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚   </p>
<p>åœ¨è¯¾ç¨‹çš„ä¾‹å­ä¸­ï¼Œå®ƒå®šä¹‰äº†â€å¥½æ„Ÿåº¦â€ï¼Œå¹¶ä¸”åªæœ‰ä¸‹é¢äº”ç§å–å€¼ï¼Œ{-2,-1,0,1,2}ï¼Œæœ€ç»ˆè¦å»ºç«‹æ¨¡å‹é¢„æµ‹å“ªäº›æ–‡æœ¬æš—ç¤ºå‘æ¨çš„äººå¯¹è‹¹æœå…¬å¸å¾ˆæ²¡æœ‰å¥½æ„Ÿï¼ˆå¥½æ„Ÿåº¦æ˜¯ï¼2ï¼‰ã€‚æœ€ç»ˆå‘ç°ï¼Œæ–‡æœ¬ä¸­å«æœ‰â€hateâ€,â€wtfâ€çš„æƒ…å†µï¼Œæ¨ä¸»å¯¹è‹¹æœå…¬å¸å¾ˆæ²¡æœ‰å¥½æ„Ÿã€‚ğŸ˜„</p>
<h4 id="IBM-Watson"><a href="#IBM-Watson" class="headerlink" title="IBM Watson"></a>IBM Watson</h4><p>Watsonçš„å·¥ä½œæ­¥éª¤æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>Find LAT<br> é¦–å…ˆå¾—ææ˜ç™½é—®é¢˜æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯è¦æ‰¾åˆ°é—®é¢˜çš„LAT(Lexial Answer Type)ã€‚<br> é—®é¢˜â€Mozartâ€™s last and perhaps most powerful symphony shares its name with this planet.â€çš„LATæ˜¯â€this planetâ€ï¼Œå› ä¸ºæŠŠç­”æ¡ˆâ€Jupiterâ€æ›¿æ¢è¿›åŸæ¥çš„å¥å­ï¼Œ<br> â€œMozartâ€™s last and perhaps most powerful symphony shares its name with Jupiterâ€<br> ä»ç„¶æ˜¯è¯´å¾—é€šçš„ã€‚</li>
<li>Generate Hypothesis<br> åœ¨æ•°æ®åº“ä¸­æœç´¢ä¸Šç™¾ä¸ªå€™é€‰ç­”æ¡ˆï¼Œæ›¿æ¢æ‰LATï¼Œç”Ÿæˆå¾ˆå¤šå‡è¯´ã€‚</li>
<li>Score Hypothesis<br> å¯¹æ¯ä¸ªå‡è¯´ï¼Œè¿›è¡Œæ–‡æœ¬æœç´¢ï¼Œå¯ä»¥å°†æœç´¢çš„åˆ°çš„ç»“æœæ•°ç›®ä½œä¸ºè¯„åˆ†ã€‚</li>
<li>Rank Hypothesis<br> å¯¹è¯„åˆ†è¿›è¡Œæ’åºï¼Œé€‰å–è¯„åˆ†æœ€é«˜çš„é‚£ä¸ªä½œä¸ºç­”æ¡ˆã€‚</li>
</ol>
<h3 id="2-å»ºæ¨¡å’Œè¯„ä¼°"><a href="#2-å»ºæ¨¡å’Œè¯„ä¼°" class="headerlink" title="2.å»ºæ¨¡å’Œè¯„ä¼°"></a>2.å»ºæ¨¡å’Œè¯„ä¼°</h3><p>é¢„å¤„ç†</p>
<pre><code># Read in the data
# ä¸è¦æŠŠæ–‡æœ¬è½¬åŒ–ä¸ºå› å­
tweets = read.csv(&quot;tweets.csv&quot;, stringsAsFactors=FALSE)

# Create dependent variable
tweets$Negative = as.factor(tweets$Avg &lt;= -1)

# Install new packages
install.packages(&quot;tm&quot;)
library(tm)
install.packages(&quot;SnowballC&quot;)
library(SnowballC)

# Create corpus
corpus = Corpus(VectorSource(tweets$Tweet))

# Convert to lower-case
corpus = tm_map(corpus, tolower)
corpus = tm_map(corpus, PlainTextDocument)

# Remove punctuation
corpus = tm_map(corpus, removePunctuation)

# Remove stopwords and apple
corpus = tm_map(corpus, removeWords, c(&quot;apple&quot;, stopwords(&quot;english&quot;)))

# Stem document 
corpus = tm_map(corpus, stemDocument)
</code></pre><p>ç»Ÿè®¡ï¼Œç”Ÿæˆå•è¯å‡ºç°æ¬¡æ•°çš„çŸ©é˜µ</p>
<pre><code># Create matrix
frequencies = DocumentTermMatrix(corpus)

# Look at matrix 
inspect(frequencies[1000:1005,505:515])

# Check for sparsity
# æ‰¾å‡ºå‡ºç°æ¬¡æ•°è‡³å°‘æœ‰20æ¬¡çš„å•è¯
findFreqTerms(frequencies, lowfreq=20)

# å¿½ç•¥99.5%çš„ç¨€ç–æ•°æ®ï¼Œåªé€‰å–0.5%ä½œä¸ºæœ‰æ•ˆæ•°æ®
# Remove sparse terms 
sparse = removeSparseTerms(frequencies, 0.995)

# Convert to a data frame
tweetsSparse = as.data.frame(as.matrix(sparse))
# Make all variable names R-friendly
colnames(tweetsSparse) = make.names(colnames(tweetsSparse))

# Add dependent variable
tweetsSparse$Negative = tweets$Negative
</code></pre><p>å»ºæ¨¡å’Œè¯„ä¼°</p>
<pre><code># Split the data
library(caTools)
set.seed(123)
split = sample.split(tweetsSparse$Negative, SplitRatio = 0.7)
trainSparse = subset(tweetsSparse, split==TRUE)
testSparse = subset(tweetsSparse, split==FALSE)

# Build a CART model
library(rpart)
library(rpart.plot)
tweetCART = rpart(Negative ~ ., data=trainSparse, method=&quot;class&quot;)
# Evaluate the performance of the model
predictCART = predict(tweetCART, newdata=testSparse, type=&quot;class&quot;)
table(testSparse$Negative, predictCART)


# Random forest model
library(randomForest)
set.seed(123)
tweetRF = randomForest(Negative ~ ., data=trainSparse)
# Make predictions:
predictRF = predict(tweetRF, newdata=testSparse)
table(testSparse$Negative, predictRF)
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-05-10-R05/" data-id="cjg0qm5no003tyyw8s258pj52" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-05-10-zuozhuan" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-05-10-zuozhuan/" class="article-date">
  <time datetime="2016-05-10T07:20:31.000Z" itemprop="datePublished">2016-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/è¯»ä¹¦/">è¯»ä¹¦</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-05-10-zuozhuan/">çœ¼å‰ï¼šæ¼«æ¸¸åœ¨ã€Šå·¦ä¼ ã€‹çš„ä¸–ç•Œ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>åäººçœ‹å†å²çš„æ—¶å€™ï¼Œä¸å¯é¿å…åœ°ç«™åœ¨ä¸Šå¸è§†è§’æ€è€ƒé—®é¢˜ã€‚<br>è¯»å²è®°ï¼Œä¸€ä¸ªäººå°†æ¥èƒ½å¤Ÿæˆå°±ä»€ä¹ˆï¼Œä»ä¸€å¼€å§‹å°±é¢„è®¾å¥½äº†ã€‚<br>åˆæˆ–è€…å¤§éƒ¨åˆ†å†å²ä¹¦ï¼Œä¸€ä¸ªç‹æœå¦‚ä½•å…´èµ·ã€æˆé•¿ã€å¼ºç››ã€è¡°è½ï¼Œä»¿ä½›å°±æ˜¯æŒ‰ç…§å‰§æœ¬æ¥æ¼”çš„ã€‚   </p>
<p>è€Œå®é™…ä¸Šï¼Œå½“æ—¶çš„äººï¼Œå“ªçŸ¥é“åæ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œå“ªçŸ¥é“åšäº†æŸä»¶äº‹æƒ…çš„ç»“æœï¼Œç”šè‡³ä¸çŸ¥é“å¤§å›½çš„å¦å¤–ä¸€ä¸ªè§’è½ï¼Œæ­¤åˆ»å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p>
<p>å°±å¥½åƒçœ‹æ¯”èµ›ç›´æ’­ï¼Œå¿ƒæƒ…å„ç§å¤æ‚ï¼Œå²‚æ­¢æ˜¯æ™šé—´æ–°é—»æŠ¥é“é‡Œä¸‰è¨€ä¸¤è¯­èƒ½å¤Ÿæ¦‚æ‹¬çš„ã€‚</p>
<hr>
<p>äºšé©¬é€Šé“¾æ¥ï¼š<a href="https://www.amazon.cn/gp/product/B01AU85S80/ref=od_aui_detailpages00?ie=UTF8&amp;psc=1" target="_blank" rel="external">çœ¼å‰ï¼šæ¼«æ¸¸åœ¨ã€Šå·¦ä¼ ã€‹çš„ä¸–ç•Œ</a> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-05-10-zuozhuan/" data-id="cjg0qm5nm003qyyw83qza288q" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/å†å²/">å†å²</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-05-10-xianluoyang" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-05-10-xianluoyang/" class="article-date">
  <time datetime="2016-05-10T07:16:19.000Z" itemprop="datePublished">2016-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/ç”Ÿæ´»/">ç”Ÿæ´»</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-05-10-xianluoyang/">2016äº”æœˆ è¥¿å®‰æ´›é˜³è¡Œè®°</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="è¥¿å®‰å°è±¡"><a href="#è¥¿å®‰å°è±¡" class="headerlink" title="è¥¿å®‰å°è±¡"></a>è¥¿å®‰å°è±¡</h4><p>å¾ˆçƒ­é—¹çš„åŸå¸‚ï¼Œè¶…å¤šæ¸¸äººã€‚<br>åƒçš„ä¸œè¥¿ï¼Œè¿˜æ˜¯è‡ªå·±æ‰¾å°å··å­æ›´å¥½ã€‚<br>å¸‚åŒºæˆ–è€…æœ‰åçš„æ–‡ä¿å•ä½æ˜æ˜¾ä¸åŠå±±è¥¿çš„é«˜è´¨é‡ã€‚å»äº†å¤§é›å¡”50é—¨ç¥¨+30ç™»å¡”ï¼Œé¡¿æ—¶å‘ç°ä½›å…‰å¯ºå°±ç®—æ”¶150é¡µä¸ç®—è´µã€‚ï¼ˆå•Šå•Šå•Šï¼Œå¯æ€œæˆ‘ç¡¬ç›˜æ•°æ®ä¸¢å¤±ï¼Œä¸¤ä¸‰å¹´çš„ç…§ç‰‡éƒ½æ²¡äº†ï¼‰<br>æœ€åå‘å¼ å›¾è¯æ˜æ¥è¿‡è¥¿å®‰ï¼š<br><img src="http://7xrjai.com1.z0.glb.clouddn.com/20160522-dyt.JPG" alt="å¤§é›å¡”">   </p>
<h4 id="æ´›é˜³å°è±¡"><a href="#æ´›é˜³å°è±¡" class="headerlink" title="æ´›é˜³å°è±¡"></a>æ´›é˜³å°è±¡</h4><p>è¶…æ£’çš„å°åŸå¸‚ï¼Œç‰¹åˆ«å–œæ¬¢å½“åœ°äººç”Ÿæ´»çš„å°å··å­ï¼Œç‰¹åˆ«æœ‰äººæ°”ï¼ï¼ˆå½“ç„¶è®©æˆ‘è‡ªå·±å»ä½æˆ‘æ˜¯ä¸æ„¿æ„çš„ï¼‰<br>å¯ä¸ºä»€ä¹ˆå¤§è¡—ä¸Šéƒ½æ˜¯åŒ»é™¢å’Œå–æˆäººç”¨å“çš„åº—å‘¢ï¼Ÿ<br>ç™½é©¬å¯ºå’Œé¾™é—¨çŸ³çªŸéƒ½è¶…èµï¼<br><img src="http://7xrjai.com1.z0.glb.clouddn.com/20160522-bms.JPG" alt="ç™½é©¬å¯º"><br><img src="http://7xrjai.com1.z0.glb.clouddn.com/20160522-lmsk.JPG" alt="é¾™é—¨çŸ³çªŸ">   </p>
<h4 id="éƒ‘å·å°è±¡"><a href="#éƒ‘å·å°è±¡" class="headerlink" title="éƒ‘å·å°è±¡"></a>éƒ‘å·å°è±¡</h4><p>è„ä¹±å·®ã€‚è¦ä¸æ˜¯è¿™æ¬¡æ²³å—åšç‰©é™¢å¤§ä¿®ï¼Œæˆ‘æ˜¯ä¸æ„¿æ„æ¥ç¬¬äºŒæ¬¡çš„ã€‚   </p>
<h4 id="å¤šä½™çš„è¯"><a href="#å¤šä½™çš„è¯" class="headerlink" title="å¤šä½™çš„è¯"></a>å¤šä½™çš„è¯</h4><p>é‚£äº›è¢«æŠ€æœ¯æ·˜æ±°çš„äº‹ç‰©ï¼šæ—…æ¸¸åœ°å›¾ï¼æ™¯åŒºç…§ç›¸<br>ä»¥å‰åˆ°è¾¾ä¸€ä¸ªåœ°æ–¹ï¼Œæ€»ä¼šç«‹é©¬ä¹°ä¸€å¼ å½“åœ°çš„åœ°å›¾ã€‚æ˜¯çš„ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œè¿™å°±æ˜¯å¤–éƒ¨ä¸–ç•Œçš„å…¥å£ã€‚è€Œå¦‚ä»Šå¤§å®¶æ—©å·²ç»ç”¨æ‰‹æœºåœ°å›¾äº†ï¼Œåœ¨ç«è½¦ç«™ï¼æ±½è½¦ç«™ï¼Œè¿˜æ˜¯èƒ½å¤Ÿé‡åˆ°ä¸å°‘è¿™æ ·çš„è€å¥¶å¥¶ï¼Œä¸¾ç€åœ°å›¾ï¼Œâ€œ5å…ƒä¸€ä»½â€ï¼Œçœ‹åˆ°è¿™æ ·çš„æƒ…æ™¯æ€»æ˜¯å¾ˆçº³é—·ï¼Œéš¾é“æ²¡æœ‰å­å¥³æé†’ä»–ä»¬ï¼Œç°åœ¨å¤§éƒ¨åˆ†äººå·²ç»ä¸ä¹°è¿™ä¸ªäº†å—ï¼Ÿ<br>åŒæ ·è¿˜æœ‰æ™¯åŒºå¿«ç…§ã€‚åœ¨ä»¥å‰æ•°ç ç›¸æœºè¿˜æ²¡æœ‰æ™®åŠçš„æ—¶å€™ï¼Œæ— å¯åšéã€‚ä½†æ˜¯ç°åœ¨è¿˜å¤§è§„æ¨¡çš„æ‰“å‡ºâ€œ5åˆ†é’Ÿå¿«ç…§â€çš„æ——å·ï¼Œä½ ä»¬çš„ä¸–ç•Œå°±ä¸æ›´æ–°å—ï¼Ÿé™¤éå æ®äº†ç‰¹åˆ«å¥½çš„æœºä½ï¼ˆåªæœ‰è¿™ä¸ªç‚¹æ‰èƒ½æ‹åˆ°å…¨æ™¯ï¼Œè€Œä¸”æˆ‘å äº†ï¼Œæ—…æ¸¸è€…è‡ªå·±æ‹ä¸åˆ°ï¼‰ï¼Œæˆ–è€…æŠ“ä½äº†æ—¶æœºï¼ˆæ¯”å¦‚åè¿‡å±±è½¦æ—¶ï¼‰ã€‚   </p>
<p>åœè½¦åœº<br>ç§¦å§‹çš‡å…µé©¬ä¿‘é™„è¿‘å†œå®¶è·‘åˆ°é©¬è·¯ä¸Šæ‹›æ½åœè½¦çš„æ¸¸äººï¼Œå£å·æ˜¯â€œåªè¦5å—ï¼Œæ™¯åŒº10å—â€ã€‚ä½ ä»¬å…¶å®æ²¡æœ‰æƒ³åˆ°ï¼Œä»–ä»¬ä¸åœ¨ä¹è¿™äº”å—åå—é’±ï¼Œä»–ä»¬åœ¨ä¹çš„æ˜¯èƒ½ä¸èƒ½å°‘èµ°ä¸¤æ­¥è·¯ï¼Œä¸è°¢ã€‚   </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-05-10-xianluoyang/" data-id="cjg0qm5ne003hyyw8p75v5iwc" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æ—…è¡Œ/">æ—…è¡Œ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æ´›é˜³/">æ´›é˜³</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/è¥¿å®‰/">è¥¿å®‰</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-05-10-R04" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-05-10-R04/" class="article-date">
  <time datetime="2016-05-10T03:44:08.000Z" itemprop="datePublished">2016-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/æ•°æ®åˆ†æç¬”è®°/">æ•°æ®åˆ†æç¬”è®°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-05-10-R04/">MIT:The Analytics Edge ç¬”è®°04ï¼å†³ç­–æ ‘å’Œéšæœºæ£®æ—</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MITè¯¾ç¨‹ <a href="https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info" target="_blank" rel="external">15.071x The Analytics Edge</a> ç¬¬å››å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚</p>
<hr>
<h2 id="Trees"><a href="#Trees" class="headerlink" title="Trees"></a>Trees</h2><p>ç¬¬å››å•å…ƒçš„ä¸»é¢˜æ˜¯å†³ç­–æ ‘å’Œéšæœºæ£®æ—ã€‚</p>
<h3 id="1-ç†è®º"><a href="#1-ç†è®º" class="headerlink" title="1.ç†è®º"></a>1.ç†è®º</h3><h4 id="CART-classification-and-regression-trees"><a href="#CART-classification-and-regression-trees" class="headerlink" title="CART(classification and regression trees)"></a>CART(classification and regression trees)</h4><h6 id="å†³ç­–æ ‘"><a href="#å†³ç­–æ ‘" class="headerlink" title="å†³ç­–æ ‘"></a>å†³ç­–æ ‘</h6><p>è‡ªå˜é‡æ˜¯å†³ç­–æ ‘ä¸Šçš„èŠ‚ç‚¹(splits)ã€‚ä½†æ˜¯æ³¨æ„ï¼Œä¸æ˜¯æ¯ä¸ªè‡ªå˜é‡éƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰çš„è‡ªå˜é‡æœ‰å¤šä¸ªèŠ‚ç‚¹(éšç€å–å€¼çš„ä¸åŒï¼Œå¯¼è‡´å› å˜é‡çš„ç»“æœä¹Ÿä¸åŒ)ï¼Œæœ‰çš„è‡ªå˜é‡æ²¡æœ‰èŠ‚ç‚¹(å¯¹å› å˜é‡å½±å“å¾ˆå°)ã€‚<br>å› å˜é‡æ˜¯å†³ç­–æ ‘ä¸Šçš„å¶å­/ç»ˆç«¯(leaves/nodes)ã€‚æ­¤å›¾ä¸Šçš„å› å˜é‡çš„å–å€¼æ˜¯0æˆ–è€…1ã€‚<br>åœ¨å„ä¸ªèŠ‚ç‚¹ï¼Œæ ¹æ®å„ä¸ªè‡ªå˜é‡çš„å–å€¼ï¼Œæœ€ç»ˆåˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå°±å¾—åˆ°äº†å› å˜é‡çš„å–å€¼ã€‚<br>æ³¨æ„ï¼Œå†³ç­–æ ‘çš„å·¦è¾¹ï¼ŒèŠ‚ç‚¹çš„åˆ¤æ–­è¯­å¥æ€»æ˜¯ä¸ºTrueï¼Yesï¼Œå³è¾¹èŠ‚ç‚¹çš„åˆ¤æ–­è¯­å¥æ€»æ˜¯ä¸ºFalseï¼Noã€‚<br><img src="http://7xrjai.com1.z0.glb.clouddn.com/20160517-tree-Rplot.png" alt="tree"><br>æœ€å·¦çš„åˆ†æ”¯è¡¨ç¤ºï¼Œå¦‚æœ LowerCou=lbr ä¸” Responde=CRI ä¸” Petition=CITï¼Œé‚£ä¹ˆå› å˜é‡çš„å–å€¼ä¸º0ã€‚<br>æœ€å³çš„åˆ†æ”¯è¡¨ç¤ºï¼Œå¦‚æœ LowerCou!=lbr ä¸” Responde=STAï¼Œé‚£ä¹ˆå› å˜é‡çš„å–å€¼ä¸º1ã€‚   </p>
<h6 id="å†³ç­–æ ‘çš„å¤§å°"><a href="#å†³ç­–æ ‘çš„å¤§å°" class="headerlink" title="å†³ç­–æ ‘çš„å¤§å°"></a>å†³ç­–æ ‘çš„å¤§å°</h6><p>minbucketå¯ä»¥ç†è§£ä¸ºï¼Œå†³ç­–æ ‘è¢«èŠ‚ç‚¹åˆ†å‰²åï¼Œæ¯ä¸ªbucketæ•°æ®çš„æ•°é‡ã€‚<br>minbucketè¶Šå¤§ï¼Œåˆ†ç»„è¶Šå°‘ï¼Œsplitè¶Šå°‘ã€‚<br>minbucketè¶Šå°ï¼Œåˆ†ç»„è¶Šå¤šï¼Œsplitè¶Šå¤šã€‚   </p>
<h6 id="Classification-tree-å’Œ-Regression-tree"><a href="#Classification-tree-å’Œ-Regression-tree" class="headerlink" title="Classification tree å’Œ Regression tree"></a>Classification tree å’Œ Regression tree</h6><ul>
<li>Classification tree analysis is when the predicted outcome is the class to which the data belongs.ï¼ˆç®€å•çš„è®²ï¼Œé¢„æµ‹å€¼æ˜¯0å’Œ1ï¼Œæ¯”å¦‚æ”¯æŒè¿˜æ˜¯åå¯¹ï¼‰</li>
<li>Regression tree analysis is when the predicted outcome can be considered a real number.ï¼ˆç®€å•çš„è®²ï¼Œé¢„æµ‹å€¼æ˜¯å¯å˜çš„ï¼Œæ¯”å¦‚æˆ¿ä»·ç­‰ç­‰ï¼‰</li>
</ul>
<p>ä½“ç°åœ¨ä»£ç ä¸­çš„è¯ï¼Œ<br>å¦‚æœæŒ‡å®šäº†type = â€œclassâ€ï¼Œé‚£ä¹ˆæ˜¯ Classification treeã€‚<br>å¦‚æœæ²¡æœ‰æŒ‡å®štype = â€œclassâ€ï¼Œé‚£ä¹ˆæ˜¯ Regression treeã€‚   </p>
<h4 id="Random-Forest"><a href="#Random-Forest" class="headerlink" title="Random Forest"></a>Random Forest</h4><p>éšæœºæ£®æ—ï¼Œè¢«è®¾è®¡å‡ºæ¥ç”¨äºæé«˜CARTçš„ç²¾åº¦ã€‚<br>å’Œå­—é¢æ„æ€ç±»ä¼¼ï¼Œå¦‚æœå†³ç­–æ ‘åªæœ‰ä¸€æ£µæ ‘ï¼Œé‚£ä¹ˆéšæœºæ£®æ—ä¼šåˆ›å»ºå¤šä¸ªå†³ç­–æ ‘ï¼Œç„¶åæ‰¾åˆ°æ•ˆæœæœ€å¥½çš„é‚£ä¸€ä¸ªã€‚<br>é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•åˆ›å»ºå¤šä¸ªå†³ç­–æ ‘çš„å‘¢ï¼Œæœ‰ç‚¹å¤æ‚ã€‚<br>å®ƒå¹¶ä¸æ˜¯å¤šæ¬¡è°ƒç”¨rpart()ï¼Œç®€å•çš„è°ƒæ•´å‡ ä¸ªå‚æ•°è€Œå·²ã€‚<br>æ¯ä¸ªå†³ç­–æ ‘æ‰€ç”¨çš„æ•°æ®ï¼Œéƒ½åªæ˜¯åŸæ•°æ®çš„éšæœºsubsetæˆ–è€…è¯´éšæœºå­é›†ã€‚<br>å¦‚æœè®­ç»ƒé›†è¢«åˆ†æˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5 è¿™äº”ä¸ªå­é›†ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡å¯èƒ½é€‰å–2ï¼Œ4ï¼Œ5ï¼Œ2ï¼Œ1ï¼Œç¬¬äºŒæ¬¡å¯èƒ½é€‰å–3ï¼Œ5ï¼Œ1ï¼Œ5ï¼Œ2ã€‚</p>
<p>å‚æ•°nodesize</p>
<pre><code>ç±»ä¼¼äºminbucketï¼Œæ¯ä¸ªå­é›†çš„æœ€å°æ•°ç›®ã€‚å®ƒè¶Šå°ï¼Œç”Ÿæˆçš„å†³ç­–æ ‘è¶Šå¤§ã€‚
</code></pre><p>å‚æ•°ntree</p>
<pre><code>ç”Ÿæˆå¤šå°‘ä¸ªå†³ç­–æ ‘ã€‚ä¸€èˆ¬å‡ ç™¾ä¸ªå°±å¤Ÿäº†ã€‚
</code></pre><p>å¥½æ¶ˆæ¯æ˜¯ï¼Œå‚æ•°çš„é€‰å–ï¼Œç›¸æ¯”CARTè€Œè¨€ï¼Œå¯¹ç»“æœçš„å½±å“æ²¡æœ‰é‚£ä¹ˆå¤§ã€‚</p>
<h4 id="Cross-Validation"><a href="#Cross-Validation" class="headerlink" title="Cross Validation"></a>Cross Validation</h4><p>minbucketåº”è¯¥é€‰å–ä»€ä¹ˆæ ·çš„å€¼ï¼Œæ¥å¤§é“æœ€å¥½æ•ˆæœå‘¢ï¼Ÿ<br>æˆ‘ä»¬é‡‡ç”¨ k-fold cross validation çš„æ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬å°†è®­ç»ƒé›†trainåˆ†æˆkä»½ï¼Œæ¯”å¦‚ k=5 çš„æ—¶å€™ï¼Œ<br>æˆ‘ä»¬å…ˆç”¨1ï¼Œ2ï¼Œ3ï¼Œ4æ¥è®­ç»ƒï¼Œ5ç”¨æ¥éªŒè¯ï¼›<br>å†ç”¨1ï¼Œ2ï¼Œ3ï¼Œ5æ¥è®­ç»ƒï¼Œ4ç”¨æ¥éªŒè¯ï¼›<br>å†ç”¨1ï¼Œ2ï¼Œ4ï¼Œ5æ¥è®­ç»ƒï¼Œ3ç”¨æ¥éªŒè¯ã€‚ã€‚ã€‚<br>æ‰€ä»¥æ¨¡å‹ä¸­åˆ›å»ºäº†å¾ˆå¤šå†³ç­–æ ‘ã€‚<br>æˆ‘ä»¬æµ‹è¯•æ¯ä¸ªåˆ†å‰²æ–¹æ³•ä¸‹ï¼Œå‚æ•°æ¯ä¸€ä¸ªå¯èƒ½çš„å–å€¼ï¼Œè®¡ç®—è¿™ä¸ªå–å€¼å¯¹åº”çš„é¢„æµ‹ç²¾åº¦ï¼Œç»˜åˆ¶æ›²çº¿ã€‚<br>æ›²çº¿çš„Xè½´æ˜¯å‚æ•°çš„å–å€¼ï¼ŒYè½´æ˜¯é¢„æµ‹ç²¾åº¦ï¼Œè¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“æ‰¾åˆ°å‚æ•°çš„æœ€ä½³å–å€¼ã€‚</p>
<h6 id="CP"><a href="#CP" class="headerlink" title="CP"></a>CP</h6><p>åƒRå¹³æ–¹ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå®šä¹‰äº†ä¸€ä¸ªæ¦‚å¿µ cp(complexity parameter) ç”¨æ¥è§‚æµ‹æ•ˆæœã€‚<br>cpè¶Šå°ï¼Œå†³ç­–æ ‘è¶Šå¤§(over fitting)ã€‚     </p>
<p><img src="http://latex.codecogs.com/svg.latex?s = splits" alt="formula"><br><img src="http://latex.codecogs.com/svg.latex?\lambda = penalty\\;error" alt="formula"><br><img src="http://latex.codecogs.com/svg.latex?\\sum_{leaves}\(RSS\\;at\\;each\\;leaf\" alt="formula"> + \lambda*s )<br><img src="http://latex.codecogs.com/svg.latex?cp = \\frac{\lambda}{RSS\(no\\;splits\" alt="formula">})<br>cpè¶Šå¤§ï¼Œåˆ†æ¯è¶Šå°ï¼Œtreeè¶Šå°ã€‚<br>cpè¶Šå°ï¼Œåˆ†æ¯è¶Šå¤§ï¼Œtreeè¶Šå¤§ã€‚</p>
<h3 id="2-å»ºæ¨¡å’Œè¯„ä¼°"><a href="#2-å»ºæ¨¡å’Œè¯„ä¼°" class="headerlink" title="2.å»ºæ¨¡å’Œè¯„ä¼°"></a>2.å»ºæ¨¡å’Œè¯„ä¼°</h3><h4 id="CART"><a href="#CART" class="headerlink" title="CART"></a>CART</h4><pre><code># Install rpart library
install.packages(&quot;rpart&quot;)
library(rpart)
install.packages(&quot;rpart.plot&quot;)
library(rpart.plot)

# CART model
# method=&quot;class&quot; è¡¨ç¤ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª classification tree
StevensTree = rpart(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, method=&quot;class&quot;, minbucket=25)

# plot tree
prp(StevensTree)

# Make predictions
# è®°å¾—æŒ‡å®š type = &quot;class&quot;
PredictCART = predict(StevensTree, newdata = Test, type = &quot;class&quot;)
table(Test$Reverse, PredictCART)

# ROC curve
library(ROCR)

PredictROC = predict(StevensTree, newdata = Test)
# æ³¨æ„è¿™é‡Œæ²¡æœ‰æŒ‡å®š type = &quot;class&quot;
# ä¹Ÿå°±æ˜¯è¯´ï¼Œå­¦ä¹ å¾—åˆ° classification tree çš„æ¨¡å‹ï¼Œä½†æ˜¯è¯„ä¼°ä½¿ç”¨ regression tree
# çœŸæ˜¯å¤©æ€çš„ã€‚ã€‚ã€‚
# è¿™ä¸ªPredictROC æœ‰ä¸¤åˆ—
# ç¬¬ä¸€åˆ—æ˜¯é¢„æµ‹y=0çš„æ¦‚ç‡
# ç¬¬äºŒåˆ—æ˜¯é¢„æµ‹y=1çš„æ¦‚ç‡
# å¦‚æœæ¯”è¾ƒä¸€ä¸‹ PredictROC æ¯è¡Œçš„æ•°æ®ï¼Œå¯ä»¥å‘ç°è¿™ä¸¤ä¸ªæ¦‚ç‡å’Œä¸º1ï¼é‚£æ˜¯å½“ç„¶ï¼
# å¦‚æœæ‹¿ PredictROC å’Œ PredictCARTç›¸æ¯”
# å¦‚æœ PredictROC[n,2]&gt;0.5ï¼Œé‚£ä¹ˆPredictCART[n]=1ã€‚
# å¦‚æœ PredictROC[n,2]&lt;0.5ï¼Œé‚£ä¹ˆPredictCART[n]=0ã€‚
# æ‰€ä»¥ä¸‹é¢æˆ‘ä»¬åªä½¿ç”¨ç¬¬äºŒåˆ—

pred = prediction(PredictROC[,2], Test$Reverse)
perf = performance(pred, &quot;tpr&quot;, &quot;fpr&quot;)
plot(perf)

# AUC
as.numeric(performance(pred, &quot;auc&quot;)@y.values)
</code></pre><h4 id="Random-Forest-1"><a href="#Random-Forest-1" class="headerlink" title="Random Forest"></a>Random Forest</h4><pre><code>install.packages(&quot;randomForest&quot;)
library(randomForest)

# Build random forest model
StevensForest = randomForest(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, ntree=200, nodesize=25 )
# Warning message:
# In randomForest.default(m, y, ...) :
#   The response has five or fewer unique values.  Are you sure you want to do regression?

# å¦‚ä¸Šé¢çš„æç¤ºæ¶ˆæ¯æ‰€ç¤º
# randomForestè®¤ä¸ºå› å˜é‡çš„å–å€¼å¾ˆå°‘ï¼Œä¸åº”è¯¥ç”¨regression
# ä½†æ˜¯ random forest æ²¡æœ‰ type = &quot;class&quot; è¿™æ ·çš„å‚æ•°
# æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç¡®ä¿å› å˜é‡è¿™ä¸€åˆ—çš„å–å€¼éƒ½æ˜¯å› å­
# Convert outcome to factor
Train$Reverse = as.factor(Train$Reverse)
Test$Reverse = as.factor(Test$Reverse)

# Try again
StevensForest = randomForest(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, ntree=200, nodesize=25 )

# Make predictions
PredictForest = predict(StevensForest, newdata = Test)
table(Test$Reverse, PredictForest)
</code></pre><h4 id="Cross-Validation-1"><a href="#Cross-Validation-1" class="headerlink" title="Cross Validation"></a>Cross Validation</h4><pre><code># Install cross-validation packages
install.packages(&quot;caret&quot;)
library(caret)
install.packages(&quot;e1071&quot;)
library(e1071)

# Define cross-validation experiment
numFolds = trainControl( method = &quot;cv&quot;, number = 10 )
cpGrid = expand.grid( .cp = seq(0.01,0.5,0.01)) 

# Perform the cross validation
train(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, method = &quot;rpart&quot;, trControl = numFolds, tuneGrid = cpGrid )

# Create a new CART model
StevensTreeCV = rpart(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, method=&quot;class&quot;, cp = 0.18)

# Make predictions
PredictCV = predict(StevensTreeCV, newdata = Test, type = &quot;class&quot;)
table(Test$Reverse, PredictCV)
</code></pre><h4 id="å‚æ•°cpå’Œlossçš„ä½¿ç”¨"><a href="#å‚æ•°cpå’Œlossçš„ä½¿ç”¨" class="headerlink" title="å‚æ•°cpå’Œlossçš„ä½¿ç”¨"></a>å‚æ•°cpå’Œlossçš„ä½¿ç”¨</h4><pre><code># Penalty Matrix
PenaltyMatrix = matrix(c(0,1,2,3,4,2,0,1,2,3,4,2,0,1,2,6,4,2,0,1,8,6,4,2,0), byrow=TRUE, nrow=5)

# CART model
ClaimsTree = rpart(bucket2009 ~ age + alzheimers + arthritis + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data=ClaimsTrain, method=&quot;class&quot;, cp=0.00005)

prp(ClaimsTree)

# Make predictions
PredictTest = predict(ClaimsTree, newdata = ClaimsTest, type = &quot;class&quot;)
# New CART model with loss matrix
ClaimsTree = rpart(bucket2009 ~ age + alzheimers + arthritis + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data=ClaimsTrain, method=&quot;class&quot;, cp=0.00005, parms=list(loss=PenaltyMatrix))

# Redo predictions and penalty error
PredictTest = predict(ClaimsTree, newdata = ClaimsTest, type = &quot;class&quot;)
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-05-10-R04/" data-id="cjg0qm5nk003nyyw8qbn7cqaz" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-04-26-R03" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-04-26-R03/" class="article-date">
  <time datetime="2016-04-25T19:52:13.000Z" itemprop="datePublished">2016-04-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/æ•°æ®åˆ†æç¬”è®°/">æ•°æ®åˆ†æç¬”è®°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-04-26-R03/">MIT:The Analytics Edge ç¬”è®°03ï¼æŒ‡æ•°å›å½’</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MITè¯¾ç¨‹ <a href="https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info" target="_blank" rel="external">15.071x The Analytics Edge</a> ç¬¬ä¸‰å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚</p>
<hr>
<h2 id="Logistic-Regression"><a href="#Logistic-Regression" class="headerlink" title="Logistic Regression"></a>Logistic Regression</h2><p>ç¬¬ä¸‰å•å…ƒçš„ä¸»é¢˜æ˜¯æŒ‡æ•°å›å½’ã€‚</p>
<h3 id="1-ç†è®º"><a href="#1-ç†è®º" class="headerlink" title="1.ç†è®º"></a>1.ç†è®º</h3><h4 id="æŒ‡æ•°å›å½’"><a href="#æŒ‡æ•°å›å½’" class="headerlink" title="æŒ‡æ•°å›å½’"></a>æŒ‡æ•°å›å½’</h4><p>æŒ‡æ•°å›å½’ç”¨äºå› å˜é‡yæ˜¯äºŒè¿›åˆ¶çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œyçš„å–å€¼åªæœ‰1æˆ–è€…0ã€‚<br>y=1çš„æ¦‚ç‡ï¼š<br><img src="http://latex.codecogs.com/svg.latex?P\(y=1\" alt="formula">=\frac{1}{1+e^{-{(\beta_0 +\beta_1x_1+\beta_2x_2+\ldots+\beta_nx_n+\epsilon)}}})  </p>
<p>y=1çš„æ¦‚ç‡ä¸yï¼0çš„æ¦‚ç‡çš„æ¯”å€¼ï¼š<br><img src="http://latex.codecogs.com/svg.latex?Odds=\\frac{P\(y=1\" alt="formula">}{P(y=0)})   </p>
<p><img src="http://latex.codecogs.com/svg.latex?Odds=\\frac{P\(y=1\" alt="formula">}{1-P(y=1)})   </p>
<p><img src="http://latex.codecogs.com/svg.latex?Odds=e^{\\beta_0 +\\beta_1x_1+\\beta_2x_2+\\ldots+\\beta_nx_n+\\epsilon}" alt="formula">   </p>
<h4 id="æ··æ·†çŸ©é˜µï¼ˆconfusion-matrixï¼‰"><a href="#æ··æ·†çŸ©é˜µï¼ˆconfusion-matrixï¼‰" class="headerlink" title="æ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰"></a>æ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰</h4><p>æœ‰é˜ˆå€¼tï¼Œ<br>å¦‚æœP(y=1) &gt;=tï¼Œåˆ™é¢„æµ‹y=1ã€‚<br>å¦‚æœP(y=1) &lt; tï¼Œåˆ™é¢„æµ‹y=0ã€‚   </p>
<p>å¯¹äºé¢„æµ‹ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°çŸ©é˜µ   </p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">predict y=0</th>
<th style="text-align:left">predict y=1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">actual y=0</td>
<td style="text-align:left">TN (True  Nagative)</td>
<td style="text-align:left">FP (False Positive)</td>
</tr>
<tr>
<td style="text-align:left">actual y=1</td>
<td style="text-align:left">FN (False Nagative)</td>
<td style="text-align:left">TP (True  Positive)</td>
</tr>
</tbody>
</table>
<p>æ ¹æ®çŸ©é˜µä¸­çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æŒ‡æ•°å›å½’çš„ä¸€äº›æŒ‡æ ‡ï¼š   </p>
<p><img src="http://latex.codecogs.com/svg.latex?accuracy=\\frac{TN+TP}{N}" alt="formula"><br><img src="http://latex.codecogs.com/svg.latex?specificity=\\frac{TN}{TN+FP}" alt="formula"><br><img src="http://latex.codecogs.com/svg.latex?sensitivity=\\frac{TP}{FN+TP}" alt="formula">   </p>
<p>è¡¥å……æ¦‚å¿µï¼š<br>é€‚åˆç‡<br><img src="http://latex.codecogs.com/svg.latex?precision=\\frac{TP}{FP+TP}" alt="formula"><br>å†ç°ç‡<br><img src="http://latex.codecogs.com/svg.latex?recall=tpr=\\frac{TP}{FN+TP}" alt="formula"><br>Få€¼ï¼ˆF-measureï¼‰<br><img src="http://latex.codecogs.com/svg.latex?F-measure=\\frac{2*precision*recall}{precision+recall}" alt="formula"><br>Få€¼è¶Šé«˜ï¼Œæ€§èƒ½è¶Šå¥½</p>
<h4 id="ROCæ›²çº¿"><a href="#ROCæ›²çº¿" class="headerlink" title="ROCæ›²çº¿"></a>ROCæ›²çº¿</h4><p>ROCæ›²çº¿ (Receiver Operator Characteristic curve)å¯ä»¥æŒ‡å¯¼æˆ‘ä»¬å¦‚ä½•é€‰å–é˜ˆå€¼tã€‚<br>yè½´çš„æŒ‡æ ‡æ˜¯ sensitivityï¼Œæ‰€ä»¥ä¹Ÿå« True positive rateã€‚   </p>
<p><img src="http://latex.codecogs.com/svg.latex?sensitivity=\\frac{TP}{FN+TP}" alt="formula"><br>xè½´çš„æŒ‡æ ‡æ˜¯ 1-specificityï¼Œæ‰€ä»¥ä¹Ÿå« False positive rateã€‚   </p>
<p><img src="http://latex.codecogs.com/svg.latex?1-sensitivity=\\frac{FP}{TN+FP}" alt="formula">    </p>
<p>æ¯å–ä¸€ä¸ªé˜ˆå€¼tï¼Œåˆ™è®¡ç®—ç›¸å¯¹åº”çš„ TPR å’Œ FPRï¼Œåœ¨åæ ‡é‡Œæ ‡å‡ºè¿™ä¸ªç‚¹ï¼Œå°±å½¢æˆROCæ›²çº¿ã€‚<br><img src="http://7xrjai.com1.z0.glb.clouddn.com/20160509-ROC.png" alt="ROC Curve">   </p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œ   </p>
<pre><code>t=0æ—¶ï¼Œæˆ‘ä»¬é¢„æµ‹æ‰€æœ‰çš„y=1ï¼Œå³TPR=1ï¼ŒFPR=1ï¼Œå¯¹åº”çš„åæ ‡æ˜¯(1,1)   
t=1æ—¶ï¼Œæˆ‘ä»¬é¢„æµ‹æ‰€æœ‰çš„y=0ï¼Œå³TPR=0ï¼ŒFPR=0ï¼Œå¯¹åº”çš„åæ ‡æ˜¯(0,0)   
</code></pre><p>è¿™å°±æ˜¯æ›²çº¿çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚</p>
<h4 id="AUCå€¼"><a href="#AUCå€¼" class="headerlink" title="AUCå€¼"></a>AUCå€¼</h4><p>AUCï¼ˆArea Under Curveï¼‰è¢«å®šä¹‰ä¸ºROCæ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œæ˜¾ç„¶è¿™ä¸ªé¢ç§¯çš„æ•°å€¼ä¸ä¼šå¤§äº1ã€‚åˆç”±äºROCæ›²çº¿ä¸€èˆ¬éƒ½å¤„äºy=xè¿™æ¡ç›´çº¿çš„ä¸Šæ–¹ï¼Œæ‰€ä»¥AUCçš„å–å€¼èŒƒå›´åœ¨0.5å’Œ1ä¹‹é—´ã€‚   </p>
<h3 id="2-å»ºç«‹å›å½’æ¨¡å‹"><a href="#2-å»ºç«‹å›å½’æ¨¡å‹" class="headerlink" title="2.å»ºç«‹å›å½’æ¨¡å‹"></a>2.å»ºç«‹å›å½’æ¨¡å‹</h3><pre><code># å»ºç«‹æ¨¡å‹
# Top10ä½œä¸ºå› å˜é‡ï¼Œå…¶ä»–æ‰€æœ‰çš„åˆ—éƒ½ä½œä¸ºè‡ªå˜é‡
SongsLog1 = glm(Top10 ~ ., data=SongsTrain, family=binomial)

# Top10ä½œä¸ºå› å˜é‡ï¼Œé™¤äº†loudnessä»¥å¤–çš„æ‰€æœ‰åˆ—éƒ½ä½œä¸ºè‡ªå˜é‡
SongsLog2 = glm(Top10 ~ . - loudness, data=SongsTrain, family=binomial)
</code></pre><h3 id="3-è¯„ä¼°"><a href="#3-è¯„ä¼°" class="headerlink" title="3.è¯„ä¼°"></a>3.è¯„ä¼°</h3><pre><code># é¢„æµ‹
testPredict = predict(SongsLog3, newdata=SongsTest, type=&quot;response&quot;)

# ç”Ÿæˆæ··æ·†çŸ©é˜µ
table(SongsTest$Top10, testPredict &gt;= 0.45)

# ç”ŸæˆROCæ›²çº¿
library(ROCR)
pred = prediction(testPredict, test$violator)
perf = performance(pred, &quot;tpr&quot;, &quot;fpr&quot;)
plot(perf)

# åŠ ç‚¹é¢œè‰²å’Œåæ ‡ç‚¹
plot(perf, colorize=TRUE, print.cutoffs.at=seq(0,1,0.1), text.adj=c(-0.2,1.7))

# è®¡ç®—AUCå€¼
as.numeric(performance(pred, &quot;auc&quot;)@y.values)
</code></pre><h3 id="é™„å½•A-åˆ†å‰²trainå’Œtestçš„æ–¹æ³•ä¸€"><a href="#é™„å½•A-åˆ†å‰²trainå’Œtestçš„æ–¹æ³•ä¸€" class="headerlink" title="é™„å½•A åˆ†å‰²trainå’Œtestçš„æ–¹æ³•ä¸€"></a>é™„å½•A åˆ†å‰²trainå’Œtestçš„æ–¹æ³•ä¸€</h3><pre><code>library(caTools)
set.seed(144)

split = sample.split(parole$violator, SplitRatio = 0.7)
train = subset(parole, split == TRUE)
test = subset(parole, split == FALSE)
# ç‰¹åˆ«æ³¨æ„ï¼šæ¯æ¬¡è¿è¡Œå‡ºæ¥çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„
</code></pre><p>ä¹Ÿå¯ä»¥è¿™æ ·åšï¼š</p>
<pre><code>library(caTools)
set.seed(144)

split = sample(1:nrow(data), size=0.7 * nrow(data))
train = data[split,]
test = data[-split,]
</code></pre><h3 id="é™„å½•B-è¡¥å……ç¼ºå¤±æ•°æ®"><a href="#é™„å½•B-è¡¥å……ç¼ºå¤±æ•°æ®" class="headerlink" title="é™„å½•B è¡¥å……ç¼ºå¤±æ•°æ®"></a>é™„å½•B è¡¥å……ç¼ºå¤±æ•°æ®</h3><pre><code>library(mice)
set.seed(144)
vars.for.imputation = setdiff(names(loans), &quot;not.fully.paid&quot;)
imputed = complete(mice(loans[vars.for.imputation]))
loans[vars.for.imputation] = imputed
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-04-26-R03/" data-id="cjg0qm5n8003eyyw8mtj1gl4d" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-04-23-R02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-04-23-R02/" class="article-date">
  <time datetime="2016-04-22T23:19:39.000Z" itemprop="datePublished">2016-04-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/æ•°æ®åˆ†æç¬”è®°/">æ•°æ®åˆ†æç¬”è®°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-04-23-R02/">MIT:The Analytics Edge ç¬”è®°02ï¼çº¿æ€§å›å½’</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MITè¯¾ç¨‹ <a href="https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info" target="_blank" rel="external">15.071x The Analytics Edge</a> ç¬¬äºŒå•å…ƒçš„å­¦ä¹ è®°å½•ã€‚</p>
<hr>
<h2 id="Linear-Regression"><a href="#Linear-Regression" class="headerlink" title="Linear Regression"></a>Linear Regression</h2><p>ç¬¬äºŒå•å…ƒçš„ä¸»é¢˜æ˜¯çº¿æ€§å›å½’ã€‚</p>
<h3 id="1-ç†è®º"><a href="#1-ç†è®º" class="headerlink" title="1.ç†è®º"></a>1.ç†è®º</h3><p>ä¸€å…ƒçº¿æ€§å›å½’å…¬å¼ï¼š   </p>
<p><img src="http://latex.codecogs.com/svg.latex?y^i=\\beta_0+\\beta_1x^i+\\epsilon^i" alt="formula">   </p>
<p>å…¶ä¸­xæ˜¯è‡ªå˜é‡independent variableï¼Œyæ˜¯å› å˜é‡dependent variableã€‚<br>betaæ˜¯ç›¸å…³ç³»æ•°coefficientï¼Œepsilonæ˜¯è¯¯å·®errorã€‚   </p>
<p>ä¸ºäº†åˆ¤æ–­çº¿æ€§å›å½’çš„æ•ˆæœï¼Œæˆ‘ä»¬æœ‰å¦‚ä¸‹æ£€éªŒæ ‡å‡†ï¼š   </p>
<p>1.SSEï¼ˆsum of squared errorsï¼‰<br>æ³¨æ„è¿™é‡Œçš„è¯¯å·®æ˜¯å®é™…å€¼ç›¸å¯¹äºé¢„æµ‹å€¼çš„ã€‚   </p>
<p><img src="http://latex.codecogs.com/svg.latex?SSE = \\sum_{i=1}^{n}\\epsilon_i^2" alt="formula">   </p>
<p>2.SST ï¼ˆtotal sum of squareï¼‰<br>å…¬å¼åŒä¸Šã€‚ä½†è¿™é‡Œçš„è¯¯å·®æ˜¯å®é™…å€¼ç›¸å¯¹äºbaselineçš„ã€‚baselineæ˜¯å› å˜é‡çš„å¹³å‡å€¼ã€‚<br>æ‰€ä»¥æœ‰ 0 &lt;= SSE &lt;= SST ã€‚ </p>
<p>3.RMSEï¼ˆroot mean square errorï¼‰   </p>
<p><img src="http://latex.codecogs.com/svg.latex?RMSE = \\sqrt\\frac{SSE}{n}" alt="formula">   </p>
<p>4.Rå¹³æ–¹   </p>
<p><img src="http://latex.codecogs.com/svg.latex?R^2 = 1 - \\frac{SSE}{SST}" alt="formula">   </p>
<p>Rå¹³æ–¹è¶Šæ¥è¿‘1è¶Šå¥½ã€‚   </p>
<p>å¤šå…ƒçº¿æ€§å›å½’å…¬å¼ï¼š   </p>
<p><img src="http://latex.codecogs.com/svg.latex?y^i = \\beta_0 + \\beta_1x_1^i + \\beta_2x_2^i + \\ldots + \\beta_nx_n^i + \\epsilon^i" alt="formula">   </p>
<pre><code>æ‰€æœ‰æ•°æ®åˆ†æï¼Œéƒ½è¦ç»å† trainingï¼testï¼predict è¿™ä¸‰ä¸ªè¿‡ç¨‹ã€‚
åœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä»‹ç» å»ºæ¨¡ï¼è¯„ä¼° è¿™å‰ä¸¤ä¸ªè¿‡ç¨‹ã€‚
</code></pre><p>è¡¥å……ä¸€ä¸ªrelative errorçš„å…¬å¼ï¼š   </p>
<p><img src="http://latex.codecogs.com/svg.latex?relative\\;error =  \\frac{observed\\;value - estimated\\,value}{observed\\;value}" alt="formula"></p>
<h5 id="2-0-äº‹å‰æ•´ç†"><a href="#2-0-äº‹å‰æ•´ç†" class="headerlink" title="2.0 äº‹å‰æ•´ç†"></a>2.0 äº‹å‰æ•´ç†</h5><p>2.0.1 å»é™¤ç©ºå€¼</p>
<pre><code># å¦‚æœæ•°æ®ä¸­åŒ…å«ç©ºå€¼
DF ï¼ na.omit(DF)
</code></pre><p>2.0.2 reference level<br>æœ‰äº›åˆ—æ—¶å­—ç¬¦å‹çš„ï¼Œå®ƒä»¬æ— æ³•è¿›è¡Œè®¡ç®—ã€‚<br>å¦‚æœæŸåˆ—çš„å› å­ä¸ç®—å¤šï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸€åˆ—å˜æ¢æˆå¤šä¸ªå¯ä»¥ç”¨äºè®¡ç®—çš„åˆ—ã€‚   </p>
<pre><code># å‡è®¾DF$colræœ‰å› å­ &quot;Red&quot;4æ¬¡, &quot;Blue&quot;3æ¬¡, &quot;Yellow&quot;2æ¬¡
DF$colr = relevel(DF$colr, &quot;red&quot;)

# æ•ˆæœæ˜¯ï¼ŒDF$colr è¿™ä¸€åˆ—ä¸è§äº†
# å¢åŠ äº†ä¸¤åˆ— DF$colrBlue å’Œ DF$colrYellow
# åŸå…ˆ DF$colr == &quot;Red&quot; çš„é‚£äº›è¡Œï¼Œå®ƒä»¬ colrBlue å’Œ colrYellow çš„å€¼éƒ½æ˜¯0
# åŸå…ˆ DF$colr == &quot;Blue&quot; çš„é‚£äº›è¡Œï¼Œå®ƒä»¬ colrBlue=1, colrYellow=0
# åŸå…ˆ DF$colr == &quot;Yellow&quot; çš„é‚£äº›è¡Œï¼Œå®ƒä»¬ colrBlue=0, colrYellow=1
</code></pre><h3 id="2-å»ºç«‹å›å½’æ¨¡å‹"><a href="#2-å»ºç«‹å›å½’æ¨¡å‹" class="headerlink" title="2.å»ºç«‹å›å½’æ¨¡å‹"></a>2.å»ºç«‹å›å½’æ¨¡å‹</h3><p>å»ºæ¨¡ä½¿ç”¨lm()å‡½æ•°ã€‚<br>DFæ˜¯ä¿å­˜å­¦ä¹ æ•°æ®çš„data.frameã€‚</p>
<pre><code>model = lm(y ~ x1 + x2 + ... +xn, data = DF)
# yä¸è¦å†™æˆ DF$y
# x1ä¹Ÿä¸è¦å†™æˆ DF$x1
# å¦åˆ™ï¼Œåé¢åšé¢„æµ‹predict()çš„æ—¶å€™ï¼ŒDFTestä»£å…¥ä¼šæŠ¥warning

# é™¤äº†yåˆ—ä»¥å¤–æ‰€æœ‰åˆ—
model = lm(y ~ ., data = DF)

# è¯¯å·® model$residuals
SSE = sum(model$residuals^2)
</code></pre><p>éšä¾¿çœ‹ä¸ªç»“æœå§</p>
<pre><code>&gt; summary(model)

Call:
lm(formula = Price ~ HarvestRain + WinterRain, data = wine)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0933 -0.3222 -0.1012  0.3871  1.1877 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.865e+00  6.616e-01  11.888 4.76e-11 ***
HarvestRain -4.971e-03  1.601e-03  -3.105  0.00516 ** 
WinterRain  -9.848e-05  9.007e-04  -0.109  0.91392    
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1

Residual standard error: 0.5611 on 22 degrees of freedom
Multiple R-squared:  0.3177,    Adjusted R-squared:  0.2557 
F-statistic: 5.122 on 2 and 22 DF,  p-value: 0.01492
</code></pre><p>Callè¡¨ç¤ºå»ºæ¨¡ä½¿ç”¨çš„è¯­å¥ã€‚<br>Residualsè¡¨ç¤ºè¯¯å·®ã€‚<br>Coefficientsè¡¨ç¤ºç³»æ•°ï¼Œå°±æ˜¯å…¬å¼é‡Œé¢çš„betaã€‚<br>Estimateçš„ç¬¬ä¸€è¡Œæ˜¯å¸¸æ•°beta0ï¼Œç¬¬äºŒè¡Œæ˜¯ç¬¬ä¸€ä¸ªè‡ªå˜é‡çš„ç³»æ•°beta1ï¼Œç¬¬ä¸‰è¡Œæ˜¯ç¬¬äºŒä¸ªè‡ªå˜é‡çš„ç³»æ•°beta2ï¼Œåé¢ç±»æ¨ã€‚<br>t valueè¶Šå¤§è¶Šå¥½</p>
<p><img src="http://latex.codecogs.com/svg.latex?{t\\,value} = \\frac{Estimate}{Std. Error}" alt="formula">   </p>
<p>Pr(&gt;|t|) å’Œt valueç›¸åï¼Œè¶Šå°è¶Šå¥½ã€‚<br>æœ€åä¸€åˆ—æ˜Ÿæ˜Ÿè¶Šå¤šè¶Šå¥½ã€‚<br>ä¸‰çŸ­æ¨ªä¸‹é¢è¿™è¡Œè§£é‡Šäº†æ˜Ÿæ˜Ÿçš„å«ä¹‰ã€‚<br>Multiple R-squaredå°±æ˜¯Rå¹³æ–¹ï¼Œè¶Šæ¥è¿‘1è¶Šå‡†ç¡®ã€‚</p>
<h3 id="3-è¯„ä¼°"><a href="#3-è¯„ä¼°" class="headerlink" title="3.è¯„ä¼°"></a>3.è¯„ä¼°</h3><p>å¯¹äºåˆšè¿‡ç®€å†çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•æ•°æ®æ¥è¯„ä¼°ä¸€ä¸‹å‡†ç¡®åº¦ã€‚<br>modelå°±æ˜¯ä¸Šæ–‡å»ºç«‹çš„æ¨¡å‹ã€‚<br>DFTestæ˜¯æµ‹è¯•æ•°æ®ï¼Œå®ƒçš„ç»“æ„å’Œä¸Šæ–‡çš„DFä¸€æ ·ã€‚   </p>
<pre><code>predict = predict(model, newdata = DFTest)
</code></pre><p>è¿™ä¸ªå‘½ä»¤çš„è¿”å›å€¼æ˜¯ DFTest$Price çš„<strong>é¢„æµ‹</strong>ç»“æœã€‚ä½ å¯ä»¥è·Ÿ DFTest$Price çš„<strong>å®é™…</strong>ç»“æœç›¸æ¯”è¾ƒï¼Œè®¡ç®—SSEã€RMSEã€Rå¹³æ–¹ç­‰ç­‰æ¥è¡¡é‡å¯¹æµ‹è¯•æ•°æ®çš„é¢„æµ‹çš„å‡†ç¡®æ€§ã€‚   </p>
<pre><code>SSE = sum( (DFTest$Price - predict)^2 )
SST = sum( (DFTest$Price - mean(DF$Price)^2 )
R2 = 1 - SSE/SST
</code></pre><h3 id="4-Correlation"><a href="#4-Correlation" class="headerlink" title="4.Correlation"></a>4.Correlation</h3><p>çº¿æ€§ç›¸å…³æ€§</p>
<pre><code>cor(var1, var2)
# ä¹Ÿå¯ä»¥è€ƒå¯Ÿæ•´ä¸ªDFä¸­ï¼Œæ¯ä¸¤åˆ—çš„çº¿æ€§ç›¸å…³æ€§
cor(DF)
</code></pre><p>è¿”å›å€¼æ˜¯æ–œç‡ã€‚   </p>
<p><strong>å»ºç«‹çº¿æ€§å›å½’æ¨¡å‹çš„æ—¶å€™ï¼Œåº”è¯¥å»æ‰ç›¸å…³æ€§æ¯”è¾ƒé«˜çš„åˆ—ã€‚</strong></p>
<h3 id="è¡¥å……çŸ¥è¯†Aï¼æ£’çƒç»Ÿè®¡æœ¯è¯­"><a href="#è¡¥å……çŸ¥è¯†Aï¼æ£’çƒç»Ÿè®¡æœ¯è¯­" class="headerlink" title="è¡¥å……çŸ¥è¯†Aï¼æ£’çƒç»Ÿè®¡æœ¯è¯­"></a>è¡¥å……çŸ¥è¯†Aï¼æ£’çƒç»Ÿè®¡æœ¯è¯­</h3><p>å®Œå…¨ä¸æ‡‚æ£’çƒå•Šï¼Œä¸€å¼€å§‹æ‘¸ä¸ç€å¤´è„‘ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">ç¼©å†™</th>
<th style="text-align:left">åŸæ–‡</th>
<th style="text-align:left">ä¸­æ–‡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">RS</td>
<td style="text-align:left">Run Scores</td>
<td style="text-align:left">è·‘åˆ†ï¼Œå¾—åˆ†</td>
</tr>
<tr>
<td style="text-align:left">RA</td>
<td style="text-align:left">Run Allowed</td>
<td style="text-align:left">å¤±åˆ†ï¼Œå¯¹æ‰‹å¾—åˆ†</td>
</tr>
<tr>
<td style="text-align:left">OBP</td>
<td style="text-align:left">On-Base Percentage</td>
<td style="text-align:left">ä¸Šå’ç‡</td>
</tr>
<tr>
<td style="text-align:left">OOBP</td>
<td style="text-align:left">Opponent On-Base Percentage</td>
<td style="text-align:left">å¯¹æ‰‹ä¸Šå’ç‡</td>
</tr>
<tr>
<td style="text-align:left">SLG</td>
<td style="text-align:left">Slugging Percentage</td>
<td style="text-align:left">é•¿æ‰“ç‡ï¼Œå‡»ä¸­ç‡</td>
</tr>
<tr>
<td style="text-align:left">OSLG</td>
<td style="text-align:left">Opponent Slugging Percentage</td>
<td style="text-align:left">å¯¹æ‰‹é•¿æ‰“ç‡</td>
</tr>
<tr>
<td style="text-align:left">BA</td>
<td style="text-align:left">Batting Avarage</td>
<td style="text-align:left">å¹³å‡æˆåŠŸç‡</td>
</tr>
</tbody>
</table>
<h3 id="è¡¥å……çŸ¥è¯†Bï¼ç¯®çƒç»Ÿè®¡æœ¯è¯­"><a href="#è¡¥å……çŸ¥è¯†Bï¼ç¯®çƒç»Ÿè®¡æœ¯è¯­" class="headerlink" title="è¡¥å……çŸ¥è¯†Bï¼ç¯®çƒç»Ÿè®¡æœ¯è¯­"></a>è¡¥å……çŸ¥è¯†Bï¼ç¯®çƒç»Ÿè®¡æœ¯è¯­</h3><p>å¹´è½»æ—¶çœ‹NBAï¼Œå¥½æ­¹çŸ¥é“ä¸€ç‚¹ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">ç¼©å†™</th>
<th style="text-align:left">åŸæ–‡</th>
<th style="text-align:left">ä¸­æ–‡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">PTS</td>
<td style="text-align:left">Points</td>
<td style="text-align:left">å¾—åˆ†</td>
</tr>
<tr>
<td style="text-align:left">oppPTS</td>
<td style="text-align:left">Opponent Points</td>
<td style="text-align:left">å¤±åˆ†ï¼Œå¯¹æ‰‹å¾—åˆ†</td>
</tr>
<tr>
<td style="text-align:left">FG</td>
<td style="text-align:left">Field Goals (success)</td>
<td style="text-align:left">è¿›çƒæ•°</td>
</tr>
<tr>
<td style="text-align:left">FGA</td>
<td style="text-align:left">Field Goals Attempted</td>
<td style="text-align:left">å‡ºæ‰‹æ¬¡æ•°</td>
</tr>
<tr>
<td style="text-align:left">X2P</td>
<td style="text-align:left">2 Points</td>
<td style="text-align:left">2åˆ†çƒè¿›çƒæ•°</td>
</tr>
<tr>
<td style="text-align:left">X2PA</td>
<td style="text-align:left">2 Points Attempted</td>
<td style="text-align:left">2åˆ†çƒå‡ºæ‰‹æ¬¡æ•°</td>
</tr>
<tr>
<td style="text-align:left">X3P</td>
<td style="text-align:left">3 Points</td>
<td style="text-align:left">3åˆ†çƒè¿›çƒæ•°</td>
</tr>
<tr>
<td style="text-align:left">X3PA</td>
<td style="text-align:left">3 Points Attempted</td>
<td style="text-align:left">3åˆ†çƒå‡ºæ‰‹æ¬¡æ•°</td>
</tr>
<tr>
<td style="text-align:left">FT</td>
<td style="text-align:left">Free Throw</td>
<td style="text-align:left">ç½šçƒè¿›çƒæ•°</td>
</tr>
<tr>
<td style="text-align:left">FTA</td>
<td style="text-align:left">Free Throw Attempted</td>
<td style="text-align:left">å‘çƒå‡ºæ‰‹æ¬¡æ•°</td>
</tr>
<tr>
<td style="text-align:left">ORB</td>
<td style="text-align:left">Offensive Rebounds</td>
<td style="text-align:left">å‰åœºç¯®æ¿ï¼Œè¿›æ”»ç¯®æ¿</td>
</tr>
<tr>
<td style="text-align:left">DRB</td>
<td style="text-align:left">Defensive Rebounds</td>
<td style="text-align:left">ååœºç¯®æ¿ï¼Œé˜²å®ˆç¯®æ¿</td>
</tr>
<tr>
<td style="text-align:left">AST</td>
<td style="text-align:left">Assists</td>
<td style="text-align:left">åŠ©æ”»</td>
</tr>
<tr>
<td style="text-align:left">STL</td>
<td style="text-align:left">Steals</td>
<td style="text-align:left">æŠ¢æ–­</td>
</tr>
<tr>
<td style="text-align:left">BLK</td>
<td style="text-align:left">Blocks</td>
<td style="text-align:left">ç›–å¸½</td>
</tr>
<tr>
<td style="text-align:left">TOV</td>
<td style="text-align:left">Turnovers</td>
<td style="text-align:left">å¤±è¯¯</td>
</tr>
</tbody>
</table>
<p>æ³¨ï¼šX2Påˆ—ï¼ŒåŸå§‹æ•°æ®åˆ—åæ˜¯2Pã€‚ç”±äºRä¸æ”¯æŒæ•°å­—å¼€å¤´çš„åˆ—åï¼å˜é‡ï¼Œè¯»å–CSVæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šåœ¨åŸåˆ—å2På‰åŠ ä¸ªXï¼Œä»è€Œå˜æˆ X2Pã€‚</p>
<h3 id="è¡¥å……çŸ¥è¯†Cï¼æ»ååºåˆ—"><a href="#è¡¥å……çŸ¥è¯†Cï¼æ»ååºåˆ—" class="headerlink" title="è¡¥å……çŸ¥è¯†Cï¼æ»ååºåˆ—"></a>è¡¥å……çŸ¥è¯†Cï¼æ»ååºåˆ—</h3><p>å‡½æ•°lagï¼Œç”¨äºç”Ÿæˆæ»å/åç§»åºåˆ—ï¼Ÿ   </p>
<pre><code>lag(x, k = 1, ...)
# k &lt; 0, previous observations   
# k &gt; 0, future observations
# na.pad=TRUE, add missing values
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-04-23-R02/" data-id="cjg0qm5n00031yyw8pa96r9tn" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-04-18-R01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-04-18-R01/" class="article-date">
  <time datetime="2016-04-18T03:55:25.000Z" itemprop="datePublished">2016-04-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/æ•°æ®åˆ†æç¬”è®°/">æ•°æ®åˆ†æç¬”è®°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-04-18-R01/">MIT:The Analytics Edge ç¬”è®°01ï¼Rè¯­è¨€å…¥é—¨</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MITè¯¾ç¨‹ <a href="https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info" target="_blank" rel="external">15.071x The Analytics Edge</a> ç¬¬ä¸€å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚</p>
<hr>
<h2 id="Rè¯­è¨€å…¥é—¨"><a href="#Rè¯­è¨€å…¥é—¨" class="headerlink" title="Rè¯­è¨€å…¥é—¨"></a>Rè¯­è¨€å…¥é—¨</h2><p>Rè¯­è¨€å…¥é—¨åªè®²äº†ä¸€äº›å¸¸ç”¨çš„æ“ä½œã€‚ç›¸å¯¹äºåŠ¨è¾„èŠ±ä¸€æœ¬ä¹¦æ¥è®²è¿™äº›ï¼ŒçœŸæ˜¯ç›¸å½“ç®€çº¦ã€‚ä½†å…¶å®è¶³å¤Ÿäº†ï¼Œå…¶ä»–æ“ä½œï¼Œéœ€è¦çš„æ—¶å€™å†æŸ¥å˜›ã€‚<br>æ•°æ®åˆ†æçš„å››è¦ç´ ï¼šdataã€modelsã€decisionsã€value    </p>
<h3 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h3><p>å¸®åŠ©ï¼š</p>
<pre><code>?func
</code></pre><p>æ˜¾ç¤ºå½“å‰çš„ä¸´æ—¶å˜é‡ï¼š</p>
<pre><code>ls()
</code></pre><p>è·å–ï¼è®¾ç½®å½“å‰ç›®å½•ï¼š</p>
<pre><code>getwd()
setwd()
</code></pre><p>æ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼š</p>
<pre><code>dir()
</code></pre><h3 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h3><p>å‘é‡æ¦‚å¿µï¼š</p>
<pre><code>æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯å¯¹å‘é‡çš„æ¯ä¸ªå…ƒç´ å®æ–½çš„
</code></pre><p>data.frameï¼š</p>
<pre><code>observationï¼šè¡Œ
variable   ï¼šåˆ—ï¼Œdata.frameæ˜¯æŒ‰ç…§åˆ—å­˜å‚¨çš„
rbind()åˆå¹¶ä¸¤ä¸ªdata.frame
</code></pre><p>åºåˆ—ï¼š</p>
<pre><code>è‡ªåŠ¨ç”Ÿæˆåºåˆ—seq()
</code></pre><h3 id="è·å–æ•°æ®"><a href="#è·å–æ•°æ®" class="headerlink" title="è·å–æ•°æ®"></a>è·å–æ•°æ®</h3><p>è¯»å–CSVæ–‡ä»¶ï¼š</p>
<pre><code>DF = read.csv(&quot;file_path&quot;)
# è¿”å›å€¼æ˜¯data.frame
</code></pre><p>æŸ¥çœ‹DFçš„åŸºæœ¬ä¿¡æ¯ï¼š</p>
<pre><code>str(DF)
# DFçš„ç»“æ„ä¿¡æ¯ã€‚è¡Œå’Œåˆ—çš„æ•°ç›®ï¼Œåˆ—åã€åˆ—çš„ç±»å‹ã€åˆ—çš„æ•°æ®ä¸¾ä¾‹ã€‚

summary(DF)
# æ¯åˆ—çš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€ä¸­ä½æ•°ã€å¹³å‡æ•°ã€1/4å€¼ã€3/4å€¼ï¼Œä»¥åŠæ˜¯å¦åŒ…å«ç©ºå€¼ã€‚
</code></pre><p>å†™å…¥CSVæ–‡ä»¶ï¼š</p>
<pre><code>write.csv(DF, &quot;file_path&quot;)
</code></pre><p>ä»å†…å­˜ä¸­åˆ é™¤å˜é‡ï¼š</p>
<pre><code>rm(DF)
</code></pre><h3 id="æ•°æ®æ“ä½œ"><a href="#æ•°æ®æ“ä½œ" class="headerlink" title="æ•°æ®æ“ä½œ"></a>æ•°æ®æ“ä½œ</h3><p>é€‰å–ä¸€éƒ¨åˆ†æ•°æ®ï¼š</p>
<pre><code>subset( DF, æ¡ä»¶1 &amp; æ¡ä»¶2 ï½œ æ¡ä»¶3)
</code></pre><p>æŒ‰ç…§åˆ—åé€‰å–3åˆ—ï¼š</p>
<pre><code>DF[c(var1, var2, var3)]
</code></pre><p>é€‰å–1ï¼Œ3ï¼Œ5åˆ—ï¼š</p>
<pre><code>DF[c(1, 3, 5)]
</code></pre><p>è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®ï¼š</p>
<pre><code>mean(DF$var)
sd(DF$var)
</code></pre><p>è¿”å›æœ€å¤§å€¼ï¼æœ€å°å€¼çš„ä½ç½®(index)ï¼š</p>
<pre><code>which.max(DF$var)
which.min(DF$var)
</code></pre><p>è¿”å›è¡Œæ•°ï¼š</p>
<pre><code>nrow(DF)
</code></pre><h3 id="ç»˜å›¾"><a href="#ç»˜å›¾" class="headerlink" title="ç»˜å›¾"></a>ç»˜å›¾</h3><p>ç›´æ–¹å›¾ï¼Œåæ˜ <strong>ä¸€åˆ—</strong>æ•°æ®çš„åˆ†å¸ƒæƒ…å†µï¼š</p>
<pre><code>hist(DF$var, xlim = c(1, 100), breaks = 100)
# xlim é™å®šèŒƒå›´
# breaks xè½´çš„ç²¾ç¡®åº¦ã€‚æ³¨æ„æ˜¯é’ˆå¯¹åŸå§‹æ•°æ®çš„ï¼Œä¸æ˜¯å¯¹é™å®šåçš„
</code></pre><p>ç®±å‹å›¾ï¼š</p>
<pre><code>boxplot(DF$var1 ~ DF$var2, xlab = &quot;x-label&quot;, ylab = &quot;y-label&quot;, main = &quot;title&quot;)
</code></pre><p>ç‚¹é˜µå›¾ï¼š</p>
<pre><code>plot(......, col = &quot;red&quot;)
line(......, col = &quot;blue&quot;) # åœ¨åŸå…ˆçš„åŸºç¡€ä¸Šå†åŠ ä¸€æ¡

å‡½æ•°jitter() # å¯¹äºæœ‰å¾ˆå¤šé‡åˆçš„ç‚¹é˜µå›¾ï¼Œå…ˆç”¨jitteråç§»ä¸€ç‚¹ï¼Œè¿™æ ·çœ‹ä¸Šå»æ•ˆæœå¥½å¾ˆå¤š
</code></pre><p>å…¶ä»–å…±é€šçš„å‚æ•°ï¼š</p>
<pre><code>col = &quot;red&quot;
type = &quot;line&quot; # å¯ä»¥æŒ‡å®š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5
</code></pre><h3 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h3><p>åˆ†ç»„ï¼š</p>
<pre><code>table(DF$var1)
# var1åˆ—ä¸­ï¼Œæ¯ç§æ•°æ®çš„æ•°é‡çš„ç»Ÿè®¡
table(DF$var1, DF$var2)
# var1å’Œvar2åˆ—ä¸­ï¼Œæ¯ç§æ•°æ®çš„æ•°é‡çš„äº¤å‰ç»Ÿè®¡
</code></pre><p>åˆ†ç»„è®¡ç®—ï¼š</p>
<pre><code>tapply(DF$var1, DF$var2, func)
# DF$var1, åŸå§‹æ•°æ®
# DF$var2, åˆ†ç»„ä¾æ®
# func, è¦åº”ç”¨çš„å‡½æ•°
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-04-18-R01/" data-id="cjg0qm5n20033yyw8u53zp2if" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-04-08-datatable5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-04-08-datatable5/" class="article-date">
  <time datetime="2016-04-07T21:00:57.000Z" itemprop="datePublished">2016-04-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/data-tableæ•™ç¨‹/">data.tableæ•™ç¨‹</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-04-08-datatable5/">data.table æ•™ç¨‹5ï¼æ•°æ®æ‹†åˆ†å’Œåˆå¹¶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç›®å½•ï¼š   </p>
<ol>
<li><a href="http://youngspring1.github.io/post/2016/2016-03-13-datatable1/">data.table ä»‹ç»</a>   </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-03-21-datatable2/">è¯­ä¹‰å¼•ç”¨</a>      </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-03-22-datatable3/">ä¸»é”®ã€åŸºäºäºŒåˆ†æ³•æœç´¢çš„subset</a>    </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-04-02-datatable4/">äºŒæ¬¡ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•</a>   </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-04-08-datatable5/">æ•°æ®æ‹†åˆ†å’Œåˆå¹¶</a>   </li>
</ol>
<p>åŸæ–‡åœ°å€ï¼š<br><a href="https://github.com/Rdatatable/data.table/wiki/Getting-started" target="_blank" rel="external">data.table/wiki/Getting-started</a></p>
<hr>
<h1 id="æ•°æ®æ‹†åˆ†å’Œåˆå¹¶"><a href="#æ•°æ®æ‹†åˆ†å’Œåˆå¹¶" class="headerlink" title="æ•°æ®æ‹†åˆ†å’Œåˆå¹¶"></a>æ•°æ®æ‹†åˆ†å’Œåˆå¹¶</h1><p>è¿™ä¸€è®²æˆ‘ä»¬å­¦ä¹ reshapingå‡½æ•° melt å’Œ dcast åŸæœ¬çš„ç”¨æ³•ï¼Œä»¥åŠä»Rè¯­è¨€ v1.9.6ç‰ˆä»¥åï¼Œå‡½æ•° melt å’Œ dcast æ–°æ‰©å±•çš„åŠŸèƒ½ï¼ˆå®ƒä»¬èƒ½æ“ä½œå¤šä¸ªåˆ—ï¼‰ã€‚   </p>
<hr>
<h2 id="æ•°æ®"><a href="#æ•°æ®" class="headerlink" title="æ•°æ®"></a>æ•°æ®</h2><p>æˆ‘ä»¬åœ¨è®²è§£çš„æ—¶å€™ç›´æ¥åŠ è½½æ•°æ®ã€‚   </p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>data.tableçš„å‡½æ•°melt å’Œ dcast æ˜¯å¢å¼ºåŒ…<a href="https://cran.r-project.org/web/packages/reshape2/index.html" target="_blank" rel="external">reshape2</a>é‡ŒåŒåå‡½æ•°çš„æ‰©å±•ã€‚<br>åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šï¼š   </p>
<ul>
<li>é¦–å…ˆï¼Œç®€å•çœ‹ä¸€ä¸‹åŸå…ˆçš„å‡½æ•° melt å’Œ dcastï¼Œå®ƒä»¬æ˜¯å¦‚ä½•reshapingä¸€ä¸ªdata.tableã€‚  </li>
<li>ç„¶åï¼Œäº†è§£ä¸€ä¸‹å½“å‰çš„åŠŸèƒ½æ˜¯å¦‚ä½•å˜å¾—å†—é•¿è€Œä¸”ä½æ•ˆã€‚   </li>
<li>æœ€åï¼Œå­¦ä¹ ä¸€ä¸‹æ”¹è¿›ä¹‹åçš„å‡½æ•° melt å’Œ dcast å¦‚ä½•åŒæ—¶å¤„ç†å¤šä¸ªåˆ—ã€‚   </li>
</ul>
<p>æ‰©å±•åçš„åŠŸèƒ½ç¬¦åˆdata.tableçš„è®¾è®¡å“²å­¦ï¼šè¿è¡Œé«˜æ•ˆï¼Œè¯­æ³•ç®€æ˜ã€‚   </p>
<p>æ³¨æ„ï¼š</p>
<pre><code>ä»Rè¯­è¨€ v1.9.6ç‰ˆä»¥åï¼Œä½ å†ä¹Ÿä¸éœ€è¦åŠ è½½å¢å¼ºåŒ… reshape2 äº†ï¼Œåªéœ€è¦åŠ è½½ data.tableã€‚å¦‚æœä½ å·²ç»åŠ è½½äº† reshape2 æ¥å¤„ç†çŸ©é˜µæˆ–è€…data.frameï¼Œé‚£ä¹ˆä¸€å®šè¦ç¡®ä¿åœ¨è¿™ä¹‹åå†åŠ è½½ data.tableã€‚
</code></pre><h2 id="1-åŸç”Ÿçš„meltï¼dcast"><a href="#1-åŸç”Ÿçš„meltï¼dcast" class="headerlink" title="1.åŸç”Ÿçš„meltï¼dcast"></a>1.åŸç”Ÿçš„meltï¼dcast</h2><h4 id="a-å‡½æ•°melt"><a href="#a-å‡½æ•°melt" class="headerlink" title="a) å‡½æ•°melt"></a>a) å‡½æ•°melt</h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸‹é¢è¿™æ ·çš„data.tableï¼š</p>
<pre><code>DT = fread(&quot;melt_default.csv&quot;)
DT
#    family_id age_mother dob_child1 dob_child2 dob_child3
# 1:         1         30 1998-11-26 2000-01-29         NA
# 2:         2         27 1996-06-22         NA         NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21
# 5:         5         29 2000-12-05 2005-02-28         NA
## dob stands for date of birth.

str(DT)
# Classes &apos;data.table&apos; and &apos;data.frame&apos;:    5 obs. of  5 variables:
#  $ family_id : int  1 2 3 4 5
#  $ age_mother: int  30 27 26 32 29
#  $ dob_child1: chr  &quot;1998-11-26&quot; &quot;1996-06-22&quot; &quot;2002-07-11&quot; &quot;2004-10-10&quot; ...
#  $ dob_child2: chr  &quot;2000-01-29&quot; NA &quot;2004-04-05&quot; &quot;2009-08-27&quot; ...
#  $ dob_child3: chr  NA NA &quot;2007-09-02&quot; &quot;2012-07-21&quot; ...
#  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;
</code></pre><p>ï¼è½¬åŒ–DTï¼Œä½¿å¾—æ¯ä¸ªå°å­©çš„å‡ºç”Ÿä¿¡æ¯éƒ½ç‹¬å ä¸€æ¡æ•°æ®<br>æˆ‘ä»¬å¯ä»¥å¯¹å‡½æ•° melt() æŒ‡å®šå‚æ•° id.vars å’Œ measure.vars æ¥å®ç°   </p>
<pre><code>DT.m1 = melt(DT, id.vars = c(&quot;family_id&quot;, &quot;age_mother&quot;),
        measure.vars = c(&quot;dob_child1&quot;, &quot;dob_child2&quot;, &quot;dob_child3&quot;))
DT.m1
#     family_id age_mother   variable      value
#  1:         1         30 dob_child1 1998-11-26
#  2:         2         27 dob_child1 1996-06-22
#  3:         3         26 dob_child1 2002-07-11
#  4:         4         32 dob_child1 2004-10-10
#  5:         5         29 dob_child1 2000-12-05
#  6:         1         30 dob_child2 2000-01-29
#  7:         2         27 dob_child2         NA
#  8:         3         26 dob_child2 2004-04-05
#  9:         4         32 dob_child2 2009-08-27
# 10:         5         29 dob_child2 2005-02-28
# 11:         1         30 dob_child3         NA
# 12:         2         27 dob_child3         NA
# 13:         3         26 dob_child3 2007-09-02
# 14:         4         32 dob_child3 2012-07-21
# 15:         5         29 dob_child3         NA
str(DT.m1)
# Classes &apos;data.table&apos; and &apos;data.frame&apos;:    15 obs. of  4 variables:
#  $ family_id : int  1 2 3 4 5 1 2 3 4 5 ...
#  $ age_mother: int  30 27 26 32 29 30 27 26 32 29 ...
#  $ variable  : Factor w/ 3 levels &quot;dob_child1&quot;,&quot;dob_child2&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
#  $ value     : chr  &quot;1998-11-26&quot; &quot;1996-06-22&quot; &quot;2002-07-11&quot; &quot;2004-10-10&quot; ...
#  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>å‚æ•° measure.vars æŒ‡å®šäº†æƒ³è¦æ‹†åˆ†ï¼ˆæˆ–åˆå¹¶ï¼‰çš„åˆ—ã€‚</li>
<li>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šç´¢å¼•è€Œä¸æ˜¯åˆ—åã€‚</li>
<li>é»˜è®¤çš„ï¼Œvariableåˆ—æ˜¯ factorï¼ˆå› å­ï¼‰ç±»å‹çš„ã€‚å¦‚æœä½ æƒ³è¿”å›ä¸€ä¸ªå­—ç¬¦å‹çš„å‘é‡ï¼Œå¯ä»¥å°†å‚æ•° variable.factor è®¾ä¸º FALSEã€‚å‚æ•° variable.factor æ˜¯data.tableçš„å‡½æ•°melt() é‡Œç‹¬æœ‰çš„ï¼Œå¢å¼ºåŒ…reshape2 é‡Œé¢æ²¡æœ‰è¿™ä¸ªå‚æ•°ã€‚</li>
<li>é»˜è®¤çš„ï¼Œè½¬åŒ–æœçš„åˆ—è¢«è‡ªåŠ¨å‘½åä¸º variable å’Œ valueã€‚</li>
<li>åœ¨ç»“æœé‡Œï¼Œå‡½æ•°melt() ä¿æŒäº†åŸæ¥åˆ—çš„å±æ€§ã€‚</li>
</ul>
<p>ï¼åˆ†åˆ«å°† variableåˆ—å’Œ valueåˆ—é‡å‘½åä¸º child å’Œ dob   </p>
<pre><code>DT.m1 = melt(DT, measure.vars = c(&quot;dob_child1&quot;, &quot;dob_child2&quot;, &quot;dob_child3&quot;),
           variable.name = &quot;child&quot;, value.name = &quot;dob&quot;)
DT.m1
#     family_id age_mother      child        dob
#  1:         1         30 dob_child1 1998-11-26
#  2:         2         27 dob_child1 1996-06-22
#  3:         3         26 dob_child1 2002-07-11
#  4:         4         32 dob_child1 2004-10-10
#  5:         5         29 dob_child1 2000-12-05
#  6:         1         30 dob_child2 2000-01-29
#  7:         2         27 dob_child2         NA
#  8:         3         26 dob_child2 2004-04-05
#  9:         4         32 dob_child2 2009-08-27
# 10:         5         29 dob_child2 2005-02-28
# 11:         1         30 dob_child3         NA
# 12:         2         27 dob_child3         NA
# 13:         3         26 dob_child3 2007-09-02
# 14:         4         32 dob_child3 2012-07-21
# 15:         5         29 dob_child3         NA
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>é»˜è®¤çš„ï¼Œå‚æ•°id.vars æˆ– measure.vars ä¸­çš„ä¸€ä¸ªçœç•¥äº†ï¼Œå‰©ä½™çš„åˆ—è‡ªåŠ¨è¢«èµ‹å€¼ç»™çœç•¥çš„é‚£ä¸ªå‚æ•°ã€‚</li>
<li>å¦‚æœå‚æ•°id.vars å’Œ measure.vars éƒ½æ²¡æœ‰æŒ‡å®šï¼Œæ‰€æœ‰ä¸æ˜¯numbericï¼integerï¼logicalçš„åˆ—éƒ½ä¼šè¢«èµ‹å€¼ç»™ id.varsã€‚å¦å¤–ï¼Œç³»ç»Ÿè¿˜ä¼šè¾“å‡ºä¸€æ¡è­¦å‘Šæ¶ˆæ¯ï¼Œæç¤ºé‚£äº›åˆ—è¢«è®¤ä¸ºæ˜¯ id.varsã€‚</li>
</ul>
<h4 id="b-å‡½æ•°cast"><a href="#b-å‡½æ•°cast" class="headerlink" title="b) å‡½æ•°cast"></a>b) å‡½æ•°cast</h4><p>åœ¨å‰é¢ä¸€èŠ‚ï¼Œæˆ‘ä»¬çŸ¥é“å¦‚ä½•åˆ†æ‹†æ•°æ®ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å­¦ä¹ ç›¸åçš„æ“ä½œã€‚<br>ï¼å¦‚ä½•å°†åˆšåˆšåˆ†æ‹†çš„ DT.m è¿˜åŸæˆ DT<br>ä¹Ÿå°±æ˜¯ï¼Œæˆ‘ä»¬æƒ³æŠŠæ¯ä¸ªå®¶åº­ï¼æ¯äº²çš„æ‰€æœ‰å°å­©ï¼Œéƒ½åˆå¹¶åˆ°åŒä¸€è¡Œé‡Œã€‚æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨å‡½æ•° dcast()ã€‚</p>
<pre><code>dcast(DT.m1, family_id + age_mother ~ child, value.var = &quot;dob&quot;)
#    family_id age_mother dob_child1 dob_child2 dob_child3
# 1:         1         30 1998-11-26 2000-01-29         NA
# 2:         2         27 1996-06-22         NA         NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21
# 5:         5         29 2000-12-05 2005-02-28         NA
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>å‡½æ•° dcast() ä½¿ç”¨äº†æ“ä½œç¬¦â€œ~â€ï¼Œå·¦è¾¹æ˜¯ä½œä¸º id.vars çš„åˆ—ï¼Œå³è¾¹æ˜¯ä½œä¸º measure.vars çš„åˆ—ã€‚</li>
<li>å‚æ•° value.var æŒ‡å®šäº†éœ€è¦è¢«åˆ†æ‹†æ‰©å¼ çš„åˆ—ã€‚</li>
<li>å‡½æ•° dcast() ä¹Ÿä¼šåœ¨ç»“æœä¸­å°½é‡ä¿æŒåŸæ¥çš„å±æ€§ã€‚</li>
</ul>
<p>ï¼å¯¹äº DT.mï¼Œå¦‚ä½•çŸ¥é“æ¯ä¸ªå®¶åº­æœ‰å‡ ä¸ªå°å­©<br>å¯ä»¥ç»™å‡½æ•° dcast() çš„å‚æ•° fun.aggregate ä¼ é€’ä¸€ä¸ªå‡½æ•°ã€‚å½“æ“ä½œç¬¦â€œ~â€ä¸æ–¹ä¾¿æŒ‡å®šåˆ—åçš„æ—¶å€™ï¼Œè¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«æœ‰ç”¨ã€‚   </p>
<pre><code>dcast(DT.m1, family_id ~ ., fun.agg = function(x) sum(!is.na(x)), value.var = &quot;dob&quot;)
#    family_id .
# 1:         1 2
# 2:         2 1
# 3:         3 3
# 4:         4 3
# 5:         5 2
</code></pre><p>è¾“å…¥ ?dcast å¯ä»¥æŸ¥çœ‹å…¶ä»–å‚æ•°å’Œä¾‹å­çš„è¯´æ˜ã€‚   </p>
<h2 id="2-åŸç”Ÿçš„meltï¼dcastçš„å±€é™"><a href="#2-åŸç”Ÿçš„meltï¼dcastçš„å±€é™" class="headerlink" title="2.åŸç”Ÿçš„meltï¼dcastçš„å±€é™"></a>2.åŸç”Ÿçš„meltï¼dcastçš„å±€é™</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å‡½æ•° melt å’Œ dcast çš„åŠŸèƒ½ï¼Œå®ƒä»¬æ˜¯åŸºäºå¢å¼ºåŒ… reshape2 çš„ã€‚ä½†æ˜¯å› ä¸ºä½¿ç”¨äº†data.tableçš„å†…éƒ¨æœºåˆ¶ï¼ˆå¿«é€Ÿæ’åºï¼ŒäºŒåˆ†æ³•æœç´¢ç­‰ï¼‰ï¼Œæ‰€ä»¥èƒ½æœ‰æ•ˆåœ°å¯¹data.tableå®è¡Œã€‚<br>ç„¶è€Œï¼Œä¹Ÿæœ‰ä¸€äº›æƒ…å†µï¼Œæˆ‘ä»¬æƒ³åšçš„æ“ä½œæ— æ³•å†™å¾—å¾ˆç®€æ´ã€‚æ¯”å¦‚ï¼Œè€ƒè™‘ä¸‹é¢è¿™ä¸ªdata.tableï¼š</p>
<pre><code>DT = fread(&quot;melt_enhanced.csv&quot;)
DT
#    family_id age_mother dob_child1 dob_child2 dob_child3 gender_child1 gender_child2 gender_child3
# 1:         1         30 1998-11-26 2000-01-29         NA             1             2            NA
# 2:         2         27 1996-06-22         NA         NA             2            NA            NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02             2             2             1
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21             1             1             1
# 5:         5         29 2000-12-05 2005-02-28         NA             2             1            NA
## 1 = female, 2 = male
</code></pre><p>å¦‚æœä½ æƒ³ç”¨æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢å­¦è¿‡çš„çŸ¥è¯†ï¼Œå°†æ¯ä¸ªå­©å­çš„ dob å’Œ gender åˆå¹¶åˆ°ä¸€è¡Œä¸­ï¼Œå¾—è¿™æ ·åšï¼š</p>
<pre><code>DT.m1 = melt(DT, id = c(&quot;family_id&quot;, &quot;age_mother&quot;))
# Warning in melt.data.table(DT, id = c(&quot;family_id&quot;, &quot;age_mother&quot;)): &apos;measure.vars&apos; [dob_child1,
# dob_child2, dob_child3, gender_child1, gender_child2, gender_child3] are not all of the same
# type. By order of hierarchy, the molten data value column will be of type &apos;character&apos;. All measure
# variables not of type &apos;character&apos; will be coerced to. Check DETAILS in ?melt.data.table for more on
# coercion.
DT.m1[, c(&quot;variable&quot;, &quot;child&quot;) := tstrsplit(variable, &quot;_&quot;, fixed = TRUE)]
DT.c1 = dcast(DT.m1, family_id + age_mother + child ~ variable, value.var = &quot;value&quot;)
DT.c1
#     family_id age_mother  child        dob gender
#  1:         1         30 child1 1998-11-26      1
#  2:         1         30 child2 2000-01-29      2
#  3:         1         30 child3         NA     NA
#  4:         2         27 child1 1996-06-22      2
#  5:         2         27 child2         NA     NA
#  6:         2         27 child3         NA     NA
#  7:         3         26 child1 2002-07-11      2
#  8:         3         26 child2 2004-04-05      2
#  9:         3         26 child3 2007-09-02      1
# 10:         4         32 child1 2004-10-10      1
# 11:         4         32 child2 2009-08-27      1
# 12:         4         32 child3 2012-07-21      1
# 13:         5         29 child1 2000-12-05      2
# 14:         5         29 child2 2005-02-28      1
# 15:         5         29 child3         NA     NA

str(DT.c1) ## gender column is character type now!
# Classes &apos;data.table&apos; and &apos;data.frame&apos;:    15 obs. of  5 variables:
#  $ family_id : int  1 1 1 2 2 2 3 3 3 4 ...
#  $ age_mother: int  30 30 30 27 27 27 26 26 26 32 ...
#  $ child     : chr  &quot;child1&quot; &quot;child2&quot; &quot;child3&quot; &quot;child1&quot; ...
#  $ dob       : chr  &quot;1998-11-26&quot; &quot;2000-01-29&quot; NA &quot;1996-06-22&quot; ...
#  $ gender    : chr  &quot;1&quot; &quot;2&quot; NA &quot;2&quot; ...
#  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt; 
#  - attr(*, &quot;sorted&quot;)= chr  &quot;family_id&quot; &quot;age_mother&quot; &quot;child&quot;
</code></pre><p>é—®é¢˜ï¼š</p>
<ol>
<li>æˆ‘ä»¬æƒ³åšçš„æ˜¯ï¼Œåˆ†åˆ«å°†æ¯ä¸ªå­©å­çš„ dob å’Œ gender åˆå¹¶åˆ°ä¸€è¡Œã€‚ä½†æ˜¯æˆ‘ä»¬å…ˆæŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½æ‹†åˆ†å¼€äº†ï¼Œå†å°†å®ƒä»¬åˆå¹¶ã€‚å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œè¿™å¤ªè¿‡è¿‚å›å’Œä½æ•ˆäº†ã€‚<br>ç±»ä¼¼çš„ï¼Œæƒ³æƒ³ä½ çš„å£æ©±é‡Œæœ‰4æ¶å­çš„è¡£æœï¼Œä½ æƒ³æŠŠç¬¬1æ¶å’Œç¬¬2æ¶çš„è¡£æœå…¨éƒ½æ”¾åˆ°ç¬¬1æ¶ä¸Šï¼ŒæŠŠç¬¬3æ¶å’Œç¬¬4æ¶çš„è¡£æœå…¨éƒ½æ”¾åˆ°ç¬¬3æ¶ä¸Šã€‚æˆ‘ä»¬åˆšåˆšåšçš„äº‹æƒ…ï¼Œå°±åƒæŠŠ4æ¶è¡£æœéƒ½æ”¾ä¸€èµ·ï¼Œå†åˆ†å¼€æ”¾åˆ°ç¬¬1æ¶å’Œç¬¬3æ¶ä¸Šï¼</li>
<li>éœ€è¦è¢«æ•´åˆçš„åˆ—å¯èƒ½æ˜¯ä¸åŒçš„ç±»å‹ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæ˜¯å­—ç¬¦å‹å’Œæ•´å‹ã€‚ä½¿ç”¨å‡½æ•°melt çš„æ—¶å€™ï¼Œè¿™äº›åˆ—è¢«ç¡¬å¡åˆ°ç»“æœé‡Œé¢ï¼Œæ­£å¦‚str(DT.c1)çš„è­¦å‘Šæ¶ˆæ¯æ‰€æç¤ºçš„ï¼Œgenderåˆ—è¢«è½¬åŒ–æˆäº†å­—ç¬¦å‹ã€‚</li>
<li>æˆ‘ä»¬å°†variableæ‹†åˆ†æˆäº†ä¸¤åˆ—ï¼Œå› æ­¤é¢å¤–å¤šäº†ä¸€åˆ—ï¼Œè¿™æ ·åšçš„ç›®çš„çœŸæ˜¯éå¸¸æ¨¡ç³Šã€‚æˆ‘ä»¬è¿™ä¹ˆåšæ˜¯å› ä¸ºä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦è½¬åŒ–è¿™ä¸€åˆ—ã€‚</li>
<li>æœ€åï¼Œæˆ‘ä»¬æ•´åˆäº†æ•°æ®ã€‚ä½†æ˜¯é—®é¢˜æ˜¯æˆ‘ä»¬å¼•å…¥å¾ˆå¤šæ“ä½œã€‚ç‰¹åˆ«æ˜¯ï¼Œå¿…é¡»è¦è®¡ç®—ç­‰å¼ä¸­å˜é‡çš„é¡ºåºï¼Œä»£ä»·å¤ªå¤§ã€‚</li>
</ol>
<p>äº‹å®ä¸Šï¼Œbase::reshape æœ‰ç®€å•çš„å†™æ³•æ¥å®ç°è¿™ä¸ªæ“ä½œã€‚å®ƒéå¸¸æœ‰ç”¨ï¼Œè€Œä¸”ç»å¸¸è¢«ä½ä¼°ã€‚ä½ åº”è¯¥è¯•è¯•ï¼   </p>
<h2 id="3-å¢å¼ºçš„æ–°åŠŸèƒ½"><a href="#3-å¢å¼ºçš„æ–°åŠŸèƒ½" class="headerlink" title="3.å¢å¼ºçš„æ–°åŠŸèƒ½"></a>3.å¢å¼ºçš„æ–°åŠŸèƒ½</h2><h4 id="a-å¢å¼ºçš„melt"><a href="#a-å¢å¼ºçš„melt" class="headerlink" title="a) å¢å¼ºçš„melt"></a>a) å¢å¼ºçš„melt</h4><p>æ—¢ç„¶æˆ‘ä»¬å¸Œæœ›ç®€å•åœ°å®ç°åŒæ ·çš„æ“ä½œï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªé¢å¤–çš„åŠŸèƒ½ï¼Œè¿™æ ·å°±å¯ä»¥åŒæ—¶æ“ä½œå¤šä¸ªåˆ—ã€‚<br>ï¼ç”¨å‡½æ•°melt åŒæ—¶æ‹†åˆ†å¤šä¸ªåˆ—<br>è¿™ä¸ªåŠæ³•å¾ˆç®€å•ã€‚æˆ‘ä»¬ç»™å‚æ•° measure.vars ä¼ é€’ä¸€ä¸ªåˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨çš„æ¯ä¸ªå…ƒç´ åŒ…å«éœ€è¦è¢«åˆå¹¶çš„åˆ—ã€‚</p>
<pre><code>colA = paste(&quot;dob_child&quot;, 1:3, sep = &quot;&quot;)
colB = paste(&quot;gender_child&quot;, 1:3, sep = &quot;&quot;)
DT.m2 = melt(DT, measure = list(colA, colB), value.name = c(&quot;dob&quot;, &quot;gender&quot;))
DT.m2
#     family_id age_mother variable        dob gender
#  1:         1         30        1 1998-11-26      1
#  2:         2         27        1 1996-06-22      2
#  3:         3         26        1 2002-07-11      2
#  4:         4         32        1 2004-10-10      1
#  5:         5         29        1 2000-12-05      2
#  6:         1         30        2 2000-01-29      2
#  7:         2         27        2         NA     NA
#  8:         3         26        2 2004-04-05      2
#  9:         4         32        2 2009-08-27      1
# 10:         5         29        2 2005-02-28      1
# 11:         1         30        3         NA     NA
# 12:         2         27        3         NA     NA
# 13:         3         26        3 2007-09-02      1
# 14:         4         32        3 2012-07-21      1
# 15:         5         29        3         NA     NA

str(DT.m2) ## col type is preserved
# Classes &apos;data.table&apos; and &apos;data.frame&apos;:    15 obs. of  5 variables:
#  $ family_id : int  1 2 3 4 5 1 2 3 4 5 ...
#  $ age_mother: int  30 27 26 32 29 30 27 26 32 29 ...
#  $ variable  : Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 1 1 1 1 2 2 2 2 2 ...
#  $ dob       : chr  &quot;1998-11-26&quot; &quot;1996-06-22&quot; &quot;2002-07-11&quot; &quot;2004-10-10&quot; ...
#  $ gender    : int  1 2 2 1 2 2 NA 2 1 1 ...
#  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;
</code></pre><p>ï¼å‡½æ•° patterns()<br>é€šå¸¸ï¼Œæˆ‘ä»¬æƒ³æ•´åˆçš„è¿™äº›åˆ—çš„åˆ—åéƒ½æœ‰å…±é€šçš„æ ¼å¼ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•°patterns()æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼ï¼Œè®©è¯­æ³•æ›´ç®€æ´ã€‚ä¸Šé¢çš„æ“ä½œè¿˜å¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code>DT.m2 = melt(DT, measure = patterns(&quot;^dob&quot;, &quot;^gender&quot;), value.name = c(&quot;dob&quot;, &quot;gender&quot;))
DT.m2
#     family_id age_mother variable        dob gender
#  1:         1         30        1 1998-11-26      1
#  2:         2         27        1 1996-06-22      2
#  3:         3         26        1 2002-07-11      2
#  4:         4         32        1 2004-10-10      1
#  5:         5         29        1 2000-12-05      2
#  6:         1         30        2 2000-01-29      2
#  7:         2         27        2         NA     NA
#  8:         3         26        2 2004-04-05      2
#  9:         4         32        2 2009-08-27      1
# 10:         5         29        2 2005-02-28      1
# 11:         1         30        3         NA     NA
# 12:         2         27        3         NA     NA
# 13:         3         26        3 2007-09-02      1
# 14:         4         32        3 2012-07-21      1
# 15:         5         29        3         NA     NA
</code></pre><p>å°±æ˜¯è¿™æ ·ï¼</p>
<ul>
<li>å¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥å»æ‰ variableåˆ—ã€‚</li>
<li>è¿™ä¸ªåŠŸèƒ½æ˜¯ç”¨Cå®ç°çš„ï¼Œå› æ­¤æ•ˆç‡é«˜ï¼ŒèŠ‚çœå†…å­˜ï¼Œè€Œä¸”ç®€æ´ã€‚</li>
</ul>
<h4 id="b-å¢å¼ºçš„dcast"><a href="#b-å¢å¼ºçš„dcast" class="headerlink" title="b) å¢å¼ºçš„dcast"></a>b) å¢å¼ºçš„dcast</h4><p>éå¸¸å¥½ï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥åŒæ—¶æ‹†åˆ†å¤šä¸ªåˆ—äº†ã€‚ç°åœ¨æˆ‘ä»¬å¦‚ä½•å°†ä¸Šé¢çš„ DT.m2 å†æ¢å¤æˆåŸæ¥çš„æ ·å­å‘¢ï¼Ÿ<br>å¦‚æœæˆ‘ä»¬ä½¿ç”¨åŸç”Ÿçš„å‡½æ•°dcast()ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤æ¬¡ï¼Œç„¶åå°†ç»“æœåˆå¹¶åœ¨ä¸€èµ·ã€‚ä½†æ˜¯è¿™æ ·åšå¤ªéº»çƒ¦ï¼Œä¸€ç‚¹ä¹Ÿä¸ç®€æ´å’Œæœ‰æ•ˆã€‚<br>ï¼åŒæ—¶åˆå¹¶å¤šä¸ª value.vars<br>æˆ‘ä»¬å¯ä»¥å¯¹å‡½æ•°dcast()æŒ‡å®šå¤šä¸ª value.varå‚æ•°ï¼Œè¿™æ ·æ“ä½œå°±åœ¨å†…éƒ¨è¿›è¡Œï¼Œè€Œä¸”é«˜æ•ˆã€‚</p>
<pre><code>## new &apos;cast&apos; functionality - multiple value.vars
DT.c2 = dcast(DT.m2, family_id + age_mother ~ variable, value.var = c(&quot;dob&quot;, &quot;gender&quot;))
DT.c2
#    family_id age_mother      dob_1      dob_2      dob_3 gender_1 gender_2 gender_3
# 1:         1         30 1998-11-26 2000-01-29         NA        1        2       NA
# 2:         2         27 1996-06-22         NA         NA        2       NA       NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02        2        2        1
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21        1        1        1
# 5:         5         29 2000-12-05 2005-02-28         NA        2        1       NA
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>åœ¨ç»“æœä¸­ï¼ŒåŸå…ˆçš„å±æ€§ä¼šå°½é‡ä¿æŒã€‚</li>
<li>æ‰€æœ‰çš„äº‹æƒ…éƒ½åœ¨å†…éƒ¨é«˜æ•ˆå¤„ç†ã€‚å¿«é€Ÿå¹¶ä¸”èŠ‚çœå†…å­˜ã€‚</li>
</ul>
<p>å‚æ•°fun.aggregateå¯ä»¥æŒ‡å®šå¤šä¸ªå‡½æ•°ï¼š</p>
<pre><code>ä½ å¯ä»¥ç»™å‡½æ•°dcast()çš„å‚æ•°fun.aggregateå¯ä»¥æŒ‡å®šå¤šä¸ªå‡½æ•°ã€‚è¯¦ç»†å†…å®¹è¯·æ‰§è¡Œ ?dcast æ¥æŸ¥çœ‹ç¤ºä¾‹ã€‚
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-04-08-datatable5/" data-id="cjg0qm5mv002vyyw82xims35f" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/data-table/">data.table</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-04-07-human-task-switches" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-04-07-human-task-switches/" class="article-date">
  <time datetime="2016-04-07T06:31:55.000Z" itemprop="datePublished">2016-04-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/è¯»ä¹¦/">è¯»ä¹¦</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-04-07-human-task-switches/">è½¬ï¼šä»»åŠ¡åˆ‡æ¢æœ‰å®³è®º</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ä¹¦æ‘˜ï¼Œæ¥è‡ªã€Šè½¯ä»¶éšæƒ³å½•ã€‹ï¼ŒJoel Spolsky </p>
</blockquote>
<p>åœ¨ç®¡ç†ä¸€ä¸ªç¨‹åºå›¢é˜Ÿæ—¶ï¼Œç¬¬ä¸€ä»¶è¦å­¦çš„äº‹å°±æ˜¯ä»»åŠ¡é…ç½®(task allocation)è¦æ­£ç¡®ã€‚ã€Œä»»åŠ¡é…ç½®ã€åªæ˜¯æŠŠäº‹æƒ…åˆ†ç»™å¤§å®¶åšçš„å¤¸å¤§è¯´æ³•ã€‚ç”¨å¸Œä¼¯æ¥æ–‡çš„æ™®é€šè¯æ¥è¯´å°±æ˜¯ã€Œå€’æ–‡ä»¶ã€(å› ä¸ºä½ ä¼šæŠŠæ–‡ä»¶å€’åœ¨æŸäººèº«ä¸Š)ã€‚æœ‰äº›äº‹æƒ…åšå¾—å¯¹ä¼šå¾—åˆ°ä¸å¯æ€è®®çš„ç”Ÿäº§åŠ›åˆ©ç›Šï¼Œå†³å®šå“ªäº›æ–‡ä»¶è¦å€’åœ¨è°èº«ä¸Šå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚åè¿‡æ¥æ²¡åšå¥½çš„è¯å¯èƒ½å°±ä¼šé™·å…¥éº»çƒ¦çš„çŠ¶å†µï¼Œæ²¡æœ‰äººèƒ½åšå¥½ä½•ä»»ä½•äº‹æƒ…è€Œä¸”å¤§å®¶éƒ½æŠ±æ€¨ã€Œåœ¨è¿™é‡Œä»€ä¹ˆäº‹éƒ½åšä¸èµ·æ¥ã€‚ã€</p>
<p>ç”±äºè¿™æ˜¯ä¸ªé’ˆå¯¹ç¨‹åºå‘˜çš„ç½‘ç«™ï¼Œæˆ‘è¦æ‹¿ä¸ªç¨‹åºè®¾è®¡é—®é¢˜è®©ä½ çš„è„‘è¢‹åŠ¨ä¸€åŠ¨æš–æš–èº«ã€‚</p>
<p>å‡è®¾ä½ æœ‰Aå’ŒBä¸¤ä»¶è¿ç®—è¦åšã€‚æ¯ä¸€ä»¶éƒ½éœ€10ç§’çš„CPUæ—¶é—´ã€‚ç°åœ¨ä½ æœ‰ä¸€é¢—CPUï¼Œä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæ‰€ä»¥å·¥ä½œåºåˆ—ä¸­æ²¡æœ‰å…¶ä»–ä¸œè¥¿ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„CPUä¸­å¯ä»¥é€‰æ‹©æ˜¯å¦ç”¨å¤šå·¥å¤„ç†ã€‚æ‰€ä»¥ä½ å¯ä»¥å…ˆåšå¥½ä¸€ä»¶å†åšå¦ä¸€ä»¶ã€‚</p>
<h5 id="å¾ªåºå¤„ç†"><a href="#å¾ªåºå¤„ç†" class="headerlink" title="å¾ªåºå¤„ç†"></a>å¾ªåºå¤„ç†</h5><p>è¿ç®—A<br>1    2    3    4    5    6    7    8    9    10<br>è¿ç®—B<br>11    12    13    14    15    16    17    18    19    20   </p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šå·¥æ–¹å¼ã€‚å¦‚æœç”¨å¤šå·¥çš„è¯å¯ä»¥å‡è®¾è¿™é¢—ç‰¹åˆ«çš„CPUæ¯ä¸ªå·¥ä½œæ¯æ¬¡å¯ä»¥æ‰§è¡Œä¸€ç§’ï¼Œè€Œä¸”å·¥ä½œåˆ‡æ¢å®Œå…¨ä¸èŠ±æ—¶é—´ã€‚</p>
<h5 id="å¤šå·¥å¤„ç†"><a href="#å¤šå·¥å¤„ç†" class="headerlink" title="å¤šå·¥å¤„ç†"></a>å¤šå·¥å¤„ç†</h5><p>è¿ç®—A<br>1    3    5    7    9    11    13    15    17    19<br>è¿ç®—B<br>2    4    6    8    10    12    14    16    18    20   </p>
<p>ä½ ä¼šé€‰å“ªä¸€ç§æ–¹å¼å‘¢ï¼Ÿå¤§éƒ¨ä»½äººçš„ç›´è§‰ååº”éƒ½è®¤ä¸ºå¤šå·¥æ¯”è¾ƒå¥½ã€‚ä¸ç®¡å“ªä¸€ç§çŠ¶å†µï¼Œéƒ½å¾—ç­‰20ç§’æ‰èƒ½ä¸¤ä»¶è¿ç®—éƒ½å®Œæˆã€‚ä¸è¿‡å¯ä»¥æƒ³æƒ³å•å°±å„ä»¶è¿ç®—æ¥è¯´è¦å¤šä¹…æ‰æœ‰ç»“æœã€‚</p>
<p>åœ¨ä¸¤ç§çŠ¶å†µä¸‹ï¼Œè¿ç®—B(æ ‡æˆè“è‰²)éƒ½è¦20ç§’æ‰å¾—åˆ°ç»“æœã€‚ä¸è¿‡è¿ç®—Açš„ç»“æœåœ¨å¤šå·¥æ—¶éœ€è¦19ç§’ã€‚å¯æ˜¯å¾ªåºæ—¶å°±åªè¦10ç§’å°±å¥½äº†ã€‚</p>
<p>æ¢å¥è¯æ¥è¯´åœ¨è¿™ä¸ªå®‰æ’å¥½çš„ä¾‹å­ä¸­ï¼Œå¾ªåºå¤„ç†çš„æ¯ä»¶è¿ç®—çš„å¹³å‡æ—¶é—´æ¯”å¤šå·¥å¤„ç†å°‘(15ç§’å¯¹19.5ç§’)ã€‚(äº‹å®ä¸Šè¿™ä¾‹å­ä¹Ÿå¹¶ä¸æ˜¯çœŸçš„é‚£ä¹ˆå‡ - å®ƒæ˜¯æºäºJaredåœ¨å·¥ä½œä¸Šå¿…é¡»è§£å†³çš„ä¸€ä¸ªçœŸå®é—®é¢˜ã€‚)</p>
<p>æ–¹æ³•    è¿ç®—AèŠ±çš„æ—¶é—´    è¿ç®—BèŠ±çš„æ—¶é—´    å¹³å‡<br>å¾ªåºå¤„ç†    10ç§’    20ç§’    15<br>å¤šå·¥å¤„ç†    19ç§’    20ç§’    19.5   </p>
<p>æˆ‘åˆšåˆšè¯´è¿‡ã€Œå·¥ä½œåˆ‡æ¢å®Œå…¨ä¸èŠ±æ—¶é—´ã€ã€‚å…¶å®åœ¨çœŸçš„CPUä¸­å·¥ä½œåˆ‡æ¢æ˜¯éœ€è¦ä¸€ç‚¹ç‚¹æ—¶é—´çš„ï¼ŒåŸºæœ¬ä¸Šè¦è¶³å¤Ÿå‚¨å­˜CPUæš‚å­˜å™¨çš„çŠ¶æ€å¹¶è½½å…¥å…¶ä»–å·¥ä½œçš„CPUæš‚å­˜å™¨ã€‚å®é™…ä¸Šè¿™çŸ­åˆ°å‡ ä¹å¯ä»¥å¿½ç•¥ã€‚ä¸è¿‡ä¸ºäº†è®©ç”Ÿæ´»æ›´å¤šä¹è¶£ï¼Œè®©æˆ‘ä»¬å‡è®¾å·¥ä½œåˆ‡æ¢éœ€è¦åŠç§’ã€‚ç°åœ¨æƒ…å†µå˜å¾—æ›´ç³Ÿäº†ï¼š</p>
<p>æ–¹æ³•    è¿ç®—AèŠ±çš„æ—¶é—´    è¿ç®—BèŠ±çš„æ—¶é—´    å¹³å‡<br>å¾ªåºå¤„ç†    10ç§’    20ç§’ + 1æ¬¡å·¥ä½œåˆ‡æ¢ = 20.5ç§’    15.25<br>å¤šå·¥å¤„ç†    19ç§’ + 18æ¬¡å·¥ä½œåˆ‡æ¢ = 28ç§’    20ç§’ + 19æ¬¡å·¥ä½œåˆ‡æ¢ = 29.5ç§’    28.75   </p>
<p>ç°åœ¨å‘¢ï¼Œè™½ç„¶æˆ‘çŸ¥é“è¿™æœ‰ç‚¹è ¢ï¼Œä¸è¿‡å°±ç®—ä¸ºäº†è®©æˆ‘é«˜å…´ä¸€ä¸‹ï¼Œæƒ³æƒ³å¦‚æœå·¥ä½œåˆ‡æ¢éœ€è¦ä¸€åˆ†é’Ÿæ‹¿å¦‚ä½•ï¼Ÿ</p>
<p>æ–¹æ³•    è¿ç®—AèŠ±çš„æ—¶é—´    è¿ç®—BèŠ±çš„æ—¶é—´    å¹³å‡<br>å¾ªåºå¤„ç†    10ç§’    20ç§’ + 1æ¬¡å·¥ä½œåˆ‡æ¢ = 80ç§’    45ç§’<br>å¤šå·¥å¤„ç†    19ç§’ + 18æ¬¡å·¥ä½œåˆ‡æ¢ = 1099ç§’    20ç§’ + 19æ¬¡å·¥ä½œåˆ‡æ¢ = 1160ç§’    å‡ è¿‘19åˆ†é’Ÿ!!   </p>
<p>å·¥ä½œåˆ‡æ¢ç”¨çš„æ—¶é—´æ„ˆé•¿ï¼Œå¤šå·¥å¤„ç†çš„ä»£ä»·æ„ˆå¤§ã€‚</p>
<p>è¿™ä»¶äº‹æœ¬èº«ä¸æ€ä¹ˆæ–°å¥‡ï¼Œä¸æ˜¯å—ï¼Ÿä¸ä¹…å¤§æ¦‚å°±ä¼šæœ‰äº›ç™½ç—´æ°”æ„¤åœ°å†™ä¿¡æŒ‡æ§æˆ‘ã€Œåå¯¹ã€å¤šå·¥å¤„ç†äº†ã€‚ä»–ä»¬ä¼šè´¨é—®æˆ‘ï¼šã€Œä½ çœŸçš„æƒ³è¦å›åˆ°é‚£ç§å¾—å…ˆç»“æŸWordPerfectæ‰èƒ½æ‰§è¡ŒLotus 1-2-3çš„DOSæ—¶ä»£å—ï¼Ÿã€</p>
<p>ä¸è¿‡é‚£å¹¶ä¸æ˜¯æˆ‘çš„æ„æ€ã€‚æˆ‘åªæ˜¯æƒ³è¦ä½ åŒæ„ï¼Œåœ¨è¿™ç±»ä¾‹å­ä¸­ï¼š</p>
<ul>
<li>å¾ªåºå¤„ç†ä¼šè®©ç»“æœå¹³å‡ä¸Šæ¯”è¾ƒå¿«å¾—åˆ°ï¼Œè€Œä¸”</li>
<li>å·¥ä½œåˆ‡æ¢éœ€è¦æ„ˆä¹…ï¼Œå¤šå·¥å¤„ç†æ‰€ä»˜çš„ä»£ä»·å°±æ„ˆå¤§ã€‚</li>
</ul>
<p>å¤Ÿäº†ï¼Œåˆ«ç®¡CPUäº†ï¼Œæ¥ç®¡ç®¡äººå§ï¼Œè¿™æœ‰è¶£å¤šäº†ã€‚è¿™é‡Œçš„é‡ç‚¹åœ¨äºç®¡ç†ã€Œç¨‹åºå‘˜ã€æ—¶ï¼Œå·¥ä½œåˆ‡æ¢ä¼šéœ€è¦å¾ˆé•¿å¾ˆé•¿çš„æ—¶é—´ã€‚å› ä¸ºç¨‹åºè®¾è®¡è¿™ç§å·¥ä½œå¿…é¡»åŒæ—¶åœ¨è„‘è¢‹é‡Œè®°å¾ˆå¤šä¸œè¥¿ã€‚å¦å¤–è®°ä½çš„ä¸œè¥¿æ„ˆå¤šï¼Œå†™ç¨‹åºæ—¶ç”Ÿäº§åŠ›æ„ˆé«˜ã€‚ç”¨å…¨é€Ÿå†™ç¨‹åºçš„ç¨‹åºå‘˜è„‘é‡Œéšæ—¶éƒ½ä¼šè®°ä½æ— æ•°çš„äº‹æƒ…ï¼šå˜é‡åç§°ï¼Œæ•°æ®ç»“æ„ï¼Œé‡è¦çš„APIï¼Œå†™è¿‡å¸¸è¦ç”¨åˆ°çš„è¾…åŠ©å‡½æ•°åç§°ï¼Œç”šè‡³å­˜æ”¾æºä»£ç çš„æ¬¡ç›®å½•åç§°ï¼Œä¸€åˆ‡ä¸œè¥¿éƒ½è¦è®°ä½ã€‚å¦‚æœä½ æŠŠç¨‹åºå‘˜é€åˆ°å…‹åˆ©ç‰¹å²›å»åº¦å‡ä¸‰æ˜ŸæœŸï¼Œä»–æ‰€æœ‰ä¸œè¥¿é€šé€šéƒ½ä¼šå¿˜æ‰ã€‚äººè„‘ä¼¼ä¹ä¼šæŠŠä¸œè¥¿ç§»å‡ºçŸ­æœŸRAMï¼Œæ”¹å­˜åˆ°æ°¸è¿œéƒ½è¯»ä¸å›æ¥çš„å¤‡ä»½ç£å¸¦ä¸Šã€‚</p>
<p>è¦å¤šä¹…å‘¢ï¼Ÿå—¯ï¼Œæˆ‘çš„è½¯ä»¶å…¬å¸æœ€è¿‘æ”¾ä¸‹æ‰‹å¤´ä¸Šåœ¨åšçš„äº‹(å¼€å‘ä¸€å¥—ä»£å·CityDeskçš„è½¯ä»¶äº§å“)ï¼ŒèŠ±äº†ä¸‰æ˜ŸæœŸå»å¸®åŠ©æŸä¸ªå®¢æˆ·å¤„ç†ä¸€ä¸ªç´§æ€¥çŠ¶å†µã€‚å½“æˆ‘ä»¬å›åˆ°åŠå…¬å®¤æ—¶ï¼Œæ„Ÿè§‰å¥½åƒè¦å¦å¤–ä¸‰æ˜ŸæœŸæ‰èƒ½å›å¤å…¨é€Ÿåˆ¶ä½œCityDeskã€‚</p>
<p>å°±ä¸ªäººå±‚æ¬¡æ¥è¯´ï¼Œä½ æ›¾ç»æ³¨æ„è¿‡æŸä»¶äº‹å—ï¼Ÿå«æŸäººåšä¸€ä¸ªå·¥ä½œå¯ä»¥åšå¾—å¾ˆå¥½ï¼Œå¯æ˜¯å¦‚æœç»™ä»–ä¸¤ä¸ªå·¥ä½œï¼Œä»–ä¼šæŠŠå…¶ä¸­ä¸€ä¸ªåšå¥½å´å¿½ç•¥å¦ä¸€ä¸ªï¼Œä¸ç„¶å°±æ˜¯ä¸¤ä»¶å·¥ä½œéƒ½åšå¾—å¾ˆæ…¢ï¼Œæ…¢åˆ°ä½ è§‰å¾—æ‡’é¬¼éƒ½æ¯”ä»–å‹¤åŠ³ã€‚è¿™æ˜¯å› ä¸ºç¨‹åºè®¾è®¡çš„å·¥ä½œå°±æ˜¯éœ€è¦å¾ˆé•¿çš„åˆ‡æ¢æ—¶é—´ã€‚å°±æˆ‘è‡ªå·±æ¥è¯´ï¼Œå½“æˆ‘éœ€è¦åŒæ—¶å®Œæˆä¸¤ä¸ªç¨‹åºè®¾è®¡é¡¹ç›®æ—¶ï¼Œåˆ‡æ¢æ—¶é—´å¤§æ¦‚è¦å…­ä¸ªå°æ—¶ã€‚ä»¥ä¸€å¤©å…«å°æ—¶æ¥çœ‹ï¼Œç­‰äºè¯´å¤šå·¥å¤„ç†æŠŠæˆ‘çš„ç”Ÿäº§åŠ›é™åˆ°æ¯å¤©åªå‰©äºŒå°æ—¶ã€‚çœŸä»¤äººæ²®ä¸§å•Šã€‚</p>
<p>åŒæ ·çš„é“ç†ï¼Œå¦‚æœä½ ç»™æŸäººä¸¤ä»¶å·¥ä½œï¼Œåº”è¯¥è¦æ„Ÿè°¢ä»–ä»¬åªåšä¸€ä»¶å·¥ä½œè€Œæ”¾å¼ƒå¦ä¸€ä»¶ï¼Œå› ä¸ºè¿™æ ·èƒ½åšå¥½æ›´å¤šçš„äº‹ï¼Œè€Œä¸”å¹³å‡ä¸Šä¹Ÿèƒ½æ›´å¿«å®Œæˆå·¥ä½œã€‚äº‹å®ä¸Šè¿™ä¸€åˆ‡çš„é‡ç‚¹å°±æ˜¯ç»å¯¹ä¸è¦è®©äººåŒæ—¶åšä¸€ä»¶ä»¥ä¸Šçš„äº‹ã€‚è¯·ç¡®å®šä½ æœ‰æ˜ç™½å®ƒçš„æ„æ€ã€‚å¥½çš„ç»ç†äººä¼šè®¤ä¸ºè‡ªå·±çš„è´£ä»»æ˜¯æ¶ˆé™¤éšœç¢ï¼Œå¥½è®©å¤§å®¶éƒ½èƒ½ä¸“æ³¨åœ¨ä¸€ä»¶äº‹æƒ…å¹¶æŠŠå®ƒçœŸçš„å®Œæˆã€‚é‡åˆ°ç´§æ€¥çŠ¶å†µæ—¶ï¼Œè¯·å…ˆæƒ³æƒ³èƒ½ä¸èƒ½è‡ªå·±å¤„ç†æ‰ï¼ŒçœŸçš„ä¸è¡Œå†ä¸¢ç»™æ·±é™·åœ¨é¡¹ç›®ä¸­çš„ç¨‹åºå‘˜å§ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-04-07-human-task-switches/" data-id="cjg0qm5n6003ayyw881cvap2i" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/joel-on-software/">joel on software</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2016-04-02-datatable4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/2016-04-02-datatable4/" class="article-date">
  <time datetime="2016-04-01T15:38:11.000Z" itemprop="datePublished">2016-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/data-tableæ•™ç¨‹/">data.tableæ•™ç¨‹</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/2016-04-02-datatable4/">data.table æ•™ç¨‹4ï¼äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç›®å½•ï¼š   </p>
<ol>
<li><a href="http://youngspring1.github.io/post/2016/2016-03-13-datatable1/">data.table ä»‹ç»</a>   </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-03-21-datatable2/">è¯­ä¹‰å¼•ç”¨</a>      </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-03-22-datatable3/">ä¸»é”®ã€åŸºäºäºŒåˆ†æ³•æœç´¢çš„subset</a>    </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-04-02-datatable4/">äºŒæ¬¡ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•</a>   </li>
<li><a href="http://youngspring1.github.io/post/2016/2016-04-08-datatable5/">æ•°æ®æ‹†åˆ†å’Œåˆå¹¶</a>   </li>
</ol>
<p>åŸæ–‡åœ°å€ï¼š<br><a href="https://github.com/Rdatatable/data.table/wiki/Getting-started" target="_blank" rel="external">data.table/wiki/Getting-started</a></p>
<hr>
<p>æ„Ÿè°¢<a href="http://weibo.com/u/2120911240" target="_blank" rel="external">G_å¤©æ˜Ÿ</a>çš„æé†’ï¼Œè²Œä¼¼ç°åœ¨ç‰ˆæœ¬çš„data.tableä¸­è¿˜æ²¡æœ‰setindex()å‡½æ•°ï¼Œæ‰€ä»¥å¯èƒ½åº”è¯¥ä½¿ç”¨set2key()å‡½æ•°ã€‚æˆ–è€…é€šè¿‡ä»£ç å®‰è£…data.tableè¯•è¯•ã€‚</p>
<hr>
<h1 id="äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•"><a href="#äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•" class="headerlink" title="äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•"></a>äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•</h1><p>æœ¬æ•™ç¨‹å‡å®šè¯»è€…å·²ç»ç†Ÿæ‚‰data.tableçš„[i, j, by]è¯­æ³•ã€æ‡‚å¾—å¦‚ä½•åŸºäºäºŒåˆ†æ³•çš„é€‰å–äº†ã€‚å¦‚æœä½ å¯¹è¿™äº›ä¸ç†Ÿæ‚‰ï¼Œè¯·å­¦ä¹ ä¸Šé¢ä¸‰è®² <a href="http://youngspring1.github.io/post/2016-03-13-datatable1/">data.table ä»‹ç»</a> ã€ <a href="http://youngspring1.github.io/post/2016-03-21-datatable2/">è¯­ä¹‰å¼•ç”¨</a>å’Œ<a href="http://youngspring1.github.io/post/2016-03-22-datatable3/">ä¸»é”®ã€åŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„subset</a>ã€‚ </p>
<hr>
<h2 id="æ•°æ®"><a href="#æ•°æ®" class="headerlink" title="æ•°æ®"></a>æ•°æ®</h2><p>æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å·²ç»ä¿å­˜åˆ°æœ¬åœ°çš„èˆªç­ä¿¡æ¯flightsã€‚</p>
<pre><code>flights &lt;- fread(&quot;flights14.csv&quot;)
head(flights)
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1        -8       -26      AA    LGA  PBI      157     1035    7
# 5: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 6: 2014     1   1         4         0      AA    EWR  LAX      339     2454   18
dim(flights)
# [1] 253316     11
</code></pre><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šï¼š   </p>
<ul>
<li>è®¨è®ºäºŒçº§ç´¢å¼•ã€‚  </li>
<li>å†æ¬¡æ¼”ç¤ºå¿«é€Ÿsubsetï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨æ–°çš„å‚æ•°onï¼Œå®ƒèƒ½è‡ªåŠ¨è®¾ç½®äºŒçº§ç´¢å¼•ã€‚</li>
<li>æœ€åè¿›ä¸€æ­¥çš„ï¼Œæ¥çœ‹ä¸€ä¸‹è‡ªåŠ¨ç´¢å¼•ï¼Œå®ƒä¹Ÿèƒ½è‡ªåŠ¨è®¾ç½®ç´¢å¼•ï¼Œä½†æ˜¯å®ƒæ˜¯åŸºäºRçš„åŸç”Ÿè¯­æ³•æ¥åšsubsetçš„ã€‚</li>
</ul>
<h2 id="1-äºŒçº§ç´¢å¼•"><a href="#1-äºŒçº§ç´¢å¼•" class="headerlink" title="1.äºŒçº§ç´¢å¼•"></a>1.äºŒçº§ç´¢å¼•</h2><h4 id="a-ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•"><a href="#a-ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•" class="headerlink" title="a) ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•"></a>a) ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•</h4><p>äºŒçº§ç´¢å¼•å’Œdata.tableçš„ä¸»é”®ç±»ä¼¼ï¼Œä½†æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒï¼š</p>
<ul>
<li>å®ƒä¸ä¼šå†å†…å­˜é‡Œå°†æ•´ä¸ªdata.tableé‡æ–°æ’åºã€‚å®ƒåªä¼šè®¡ç®—æŸåˆ—çš„é¡ºåºï¼Œå°†è¿™ä¸ªé¡ºåºå‘é‡ä¿å­˜åœ¨ä¸€ä¸ªé¢å¤–çš„ï¼Œå«åšindexçš„å±æ€§é‡Œé¢ã€‚</li>
<li>ä¸€ä¸ªdata.tableå¯ä»¥æœ‰å¤šä¸ªäºŒçº§ç´¢å¼•ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸‹é¢è¦æ¼”ç¤ºçš„ã€‚</li>
</ul>
<h4 id="b-è®¾ç½®å’Œè·å–äºŒçº§ç´¢å¼•"><a href="#b-è®¾ç½®å’Œè·å–äºŒçº§ç´¢å¼•" class="headerlink" title="b) è®¾ç½®å’Œè·å–äºŒçº§ç´¢å¼•"></a>b) è®¾ç½®å’Œè·å–äºŒçº§ç´¢å¼•</h4><p>ï¼å¦‚ä½•å°†originåˆ—è®¾ç½®ä¸ºè¯¥data.tableçš„äºŒçº§ç´¢å¼•</p>
<pre><code>setindex(flights, origin)
head(flights)
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1        -8       -26      AA    LGA  PBI      157     1035    7
# 5: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 6: 2014     1   1         4         0      AA    EWR  LAX      339     2454   18

## alternatively we can provide character vectors to the function &apos;setindexv()&apos;
# setindexv(flights, &quot;origin&quot;) # useful to program with

# &apos;index&apos; attribute added
names(attributes(flights))
# [1] &quot;names&quot;             &quot;row.names&quot;         &quot;class&quot;             &quot;.internal.selfref&quot;
# [5] &quot;index&quot;
</code></pre><p>è¯´æ˜ï¼š   </p>
<ul>
<li>å‡½æ•°setindex å’Œ setindexv()å¯ä»¥å¯¹data.tableæ·»åŠ ä¸€ä¸ªäºŒçº§ç´¢å¼•ã€‚</li>
<li>æ³¨æ„flightså®é™…ä¸Šæ²¡æœ‰æŒ‰ç…§originåˆ—çš„å‡åºé‡æ–°æ’åˆ—ã€‚è¿˜è®°å¾—å—ï¼Ÿsetkey()ä¼šé‡æ–°æ’åºï¼</li>
<li>setindex(flights, NULL)ä¼šåˆ é™¤æ‰€æœ‰çš„äºŒçº§ç´¢å¼•ã€‚</li>
</ul>
<p>ï¼å¦‚ä½•å–å¾—flightsçš„äºŒçº§ç´¢å¼•</p>
<pre><code>indices(flights)
# [1] &quot;origin&quot;

setindex(flights, origin, dest)
indices(flights)
# [1] &quot;origin&quot;       &quot;origin__dest&quot;
</code></pre><p>è¯´æ˜ï¼š   </p>
<ul>
<li>å‡½æ•°indices()è¿”å›ä¸€ä¸ªdata.tableæ‰€æœ‰çš„äºŒçº§ç´¢å¼•ã€‚å¦‚æœè¯¥data.tableæ²¡æœ‰äºŒçº§ç´¢å¼•ï¼Œé‚£ä¹ˆè¿”å›NULLã€‚</li>
<li>æ³¨æ„æˆ‘ä»¬å¯¹ originåˆ—,deståˆ—åˆ›å»ºäº†å¦ä¸€ä¸ªäºŒçº§ç´¢å¼•çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸¢æ‰ä¹‹å‰åˆ›å»ºçš„ç¬¬ä¸€ä¸ªäºŒçº§ç´¢å¼•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸ªäºŒçº§ç´¢å¼•ã€‚</li>
</ul>
<h4 id="c-ä¸ºä»€ä¹ˆä½¿ç”¨äºŒçº§ç´¢å¼•"><a href="#c-ä¸ºä»€ä¹ˆä½¿ç”¨äºŒçº§ç´¢å¼•" class="headerlink" title="c) ä¸ºä»€ä¹ˆä½¿ç”¨äºŒçº§ç´¢å¼•"></a>c) ä¸ºä»€ä¹ˆä½¿ç”¨äºŒçº§ç´¢å¼•</h4><p>ï¼å¯¹ä¸€ä¸ªdata.tableé‡æ–°æ’åºæˆæœ¬å¤ªé«˜<br>è€ƒè™‘ä¸€ä¸‹è¿™ç§æƒ…å†µï¼Œå½“ä½ æƒ³ç”¨ä¸»é”®originåˆ—æ¥subsetæ‰€æœ‰â€œJFKâ€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—è¿™ä¹ˆåšï¼š</p>
<pre><code>## not run
setkey(flights, origin)
flights[&quot;JFK&quot;] # or flights[.(&quot;JFK&quot;)]
</code></pre><p>è¯´æ˜ï¼š</p>
<pre><code>setkey()éœ€è¦ï¼š
a.è®¡ç®—å¾—å‡ºoriginåˆ—çš„æ’åºå‘é‡ï¼Œå¹¶ä¸”
b.åŸºäºåˆšåˆšçš„æ’åºå‘é‡ï¼Œå¯¹æ•´ä¸ªdata.tableé‡æ–°æ’åº
</code></pre><p>æ’åºå¹¶ä¸æ˜¯æœ€èŠ±æ—¶é—´çš„ï¼Œå› ä¸ºdata.tableä½¿ç”¨å¯¹æ•´å‹ã€å­—ç¬¦å‹ã€æ•°å€¼å‹çš„å‘é‡è¿›è¡Œradixæ’åºã€‚ç„¶è€Œé‡æ–°æ’åºå´å¾ˆèŠ±æ—¶é—´ã€‚<br>é™¤éæˆ‘ä»¬éœ€è¦å¯¹æŸä¸€åˆ—é‡å¤åœ°è¿›è¡Œsubsetï¼Œå¦åˆ™äºŒåˆ†æ³•å¿«é€Ÿsubsetçš„é«˜æ•ˆå¯èƒ½è¢«é‡æ–°æ’åºæŠµæ¶ˆã€‚   </p>
<p>ï¼ä¸ºæ·»åŠ ï¼æ›´æ–°åˆ—è€Œå¯¹æ•´ä¸ªdata.tableé‡æ–°æ’åºå¹¶ä¸ç†æƒ³<br>ï¼æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªä¸»é”®<br>ç°åœ¨æˆ‘ä»¬å¦‚æœæƒ³å¯¹deståˆ—æ˜¯â€œLAXâ€çš„è¡Œï¼Œé‡å¤åœ°è¿›è¡ŒæŸä¸ªç‰¹å®šçš„æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»å†è°ƒç”¨å‡½æ•°setkey() è®¾ç½®ä¸€æ¬¡ä¸»é”®ã€‚   </p>
<pre><code>## not run
setkey(flights, dest)
flights[&quot;LAX&quot;]
</code></pre><p>è¿™æ ·ï¼Œflightsåˆå†æ¬¡æŒ‰deståˆ—é‡æ–°æ’åºäº†ã€‚å…¶å®æˆ‘ä»¬çœŸæ­£æƒ³åšçš„æ˜¯ï¼Œå¿«é€Ÿåœ°subsetåŒæ—¶åˆä¸å¿…é‡æ–°æ’åºã€‚<br>è¿™æ—¶å€™ï¼ŒäºŒçº§ç´¢å¼•å°±æ´¾ä¸Šç”¨åœºäº†ï¼   </p>
<p>ï¼äºŒçº§ç´¢å¼•å¯ä»¥è¢«é‡ç”¨<br>æ—¢ç„¶ä¸€ä¸ªdata.tableä¸­å¯ä»¥æœ‰å¤šä¸ªäºŒçº§ç´¢å¼•ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªäºŒçº§ç´¢å¼•å°±å’Œå°†ä¸€ä¸ªæ’åºå‘é‡ä¿å­˜ä¸ºå±æ€§ä¸€æ ·ç®€å•ï¼Œé‚£ä¹ˆåˆ›å»ºäºŒçº§ç´¢å¼•åï¼Œæˆ‘ä»¬å¯ä»¥çœä¸‹é‡æ–°æ’åºçš„æ—¶é—´ã€‚<br>ï¼å‚æ•°onä½¿å¾—è¯­æ³•æ›´ç®€æ´ï¼Œå¹¶ä¸”èƒ½è‡ªåŠ¨åˆ›å»ºå¹¶é‡ç”¨äºŒçº§ç´¢å¼•<br>æˆ‘ä»¬ä¸‹é¢ä¸€èŠ‚ä¼šè¯´æ˜å‚æ•°onçš„å‡ ä¸ªä¼˜ç‚¹ï¼š   </p>
<p>å‚æ•°on</p>
<ul>
<li>é€šè¿‡åˆ›å»ºç´¢å¼•è¿›è¡Œsubsetã€‚æ¯æ¬¡éƒ½èƒ½èŠ‚çœsetindex()çš„æ—¶é—´ã€‚</li>
<li>é€šè¿‡æ£€æŸ¥å±æ€§ï¼Œå¯ä»¥ç®€å•åœ°é‡ç”¨å·²ç»å­˜åœ¨çš„äºŒçº§ç´¢å¼•ã€‚</li>
<li>è¯­æ³•ç®€å•ã€‚<br>æ³¨æ„å‚æ•°onä¹Ÿå¯ä»¥ç”¨æ¥æŒ‡å®šä¸»é”®ã€‚äº‹å®ä¸Šï¼Œä¸ºäº†æ›´ä½³çš„å¯è¯»æ€§ï¼Œæˆ‘ä»¬é¼“åŠ±åœ¨å‚æ•°oné‡Œé¢æŒ‡å®šä¸»é”®ã€‚</li>
</ul>
<h2 id="2-ä½¿ç”¨å‚æ•°onå’Œç´¢å¼•è¿›è¡Œå¿«é€Ÿsubset"><a href="#2-ä½¿ç”¨å‚æ•°onå’Œç´¢å¼•è¿›è¡Œå¿«é€Ÿsubset" class="headerlink" title="2.ä½¿ç”¨å‚æ•°onå’Œç´¢å¼•è¿›è¡Œå¿«é€Ÿsubset"></a>2.ä½¿ç”¨å‚æ•°onå’Œç´¢å¼•è¿›è¡Œå¿«é€Ÿsubset</h2><h4 id="a-å‚æ•°ié‡Œçš„subset"><a href="#a-å‚æ•°ié‡Œçš„subset" class="headerlink" title="a) å‚æ•°ié‡Œçš„subset"></a>a) å‚æ•°ié‡Œçš„subset</h4><p>ï¼subsetæ‰€æœ‰originæ˜¯â€œJFKâ€çš„è¡Œ</p>
<pre><code>flights[&quot;JFK&quot;, on = &quot;origin&quot;]
#        year month day dep_delay arr_delay carrier origin dest air_time distance hour
#     1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
#     2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
#     3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
#     4: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
#     5: 2014     1   1        -2       -18      AA    JFK  LAX      338     2475   21
#    ---
# 81479: 2014    10  31        -4       -21      UA    JFK  SFO      337     2586   17
# 81480: 2014    10  31        -2       -37      UA    JFK  SFO      344     2586   18
# 81481: 2014    10  31         0       -33      UA    JFK  LAX      320     2475   17
# 81482: 2014    10  31        -6       -38      UA    JFK  SFO      343     2586    9
# 81483: 2014    10  31        -6       -38      UA    JFK  LAX      323     2475   11

## alternatively
# flights[.(&quot;JFK&quot;), on = &quot;origin&quot;] (or) 
# flights[list(&quot;JFK&quot;), on = &quot;origin&quot;]
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>è¿™æ®µè¯­å¥æ‰§è¡Œçš„subsetä¹Ÿæ˜¯é€šè¿‡åˆ›å»ºäºŒçº§ç´¢å¼•ï¼ŒåŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„ã€‚ä½†è®°ä½ï¼Œå®ƒä¸ä¼šæŠŠè¿™ä¸ªäºŒçº§ç´¢å¼•è‡ªåŠ¨åˆ›å»ºä¸ºdata.tableçš„ä¸€ä¸ªå±æ€§ã€‚å½“ç„¶åé¢æˆ‘ä»¬ä¹Ÿä¼šæ•™ä½ å¦‚ä½•å°†å®ƒè®¾ç½®ä¸ºä¸€ä¸ªå±æ€§ã€‚   </li>
<li>å¦‚æœæˆ‘ä»¬å·²ç»æ·»åŠ äº†ä¸€ä¸ªäºŒçº§ç´¢å¼•äº†ï¼Œé‚£ä¹ˆå‚æ•°onå°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªäºŒçº§ç´¢å¼•ï¼Œè€Œä¸æ˜¯å†å¯¹æ•´ä¸ªèˆªç­ä¿¡æ¯flightsè¿›è¡Œè®¡ç®—ã€‚   </li>
</ul>
<p>æˆ‘ä»¬æ¥çœ‹ä¸‹é¢ verbose = TRUE çš„ç”¨æ³•ï¼š</p>
<pre><code>setindex(flights, origin)
flights[&quot;JFK&quot;, on = &quot;origin&quot;, verbose = TRUE][1:5]
# names(on) = NULL. Assigning &apos;on&apos; to names(on)&apos; as well.
# Looking for existing (secondary) index... found. Reusing index.
# Starting bmerge ...done in 0 secs
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 5: 2014     1   1        -2       -18      AA    JFK  LAX      338     2475   21
</code></pre><p>ï¼å¦‚ä½•å¯¹originåˆ—å’Œdeståˆ—è¿›è¡Œsubset<br>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³é€‰å–æ‰€æœ‰ä»â€œJFKâ€èµ·é£åˆ°è¾¾â€œLAXâ€çš„æ‰€æœ‰èˆªç­ï¼š</p>
<pre><code>flights[.(&quot;JFK&quot;, &quot;LAX&quot;), on = c(&quot;origin&quot;, &quot;dest&quot;)][1:5]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 5: 2014     1   1        -2       -18      AA    JFK  LAX      338     2475   21
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>åœ¨å‚æ•°ié‡Œé¢æŒ‡å®šå–å€¼ï¼Œåœ¨å‚æ•°oné‡Œé¢æŒ‡å®šåˆ—åã€‚å‚æ•°onå¿…é¡»æ˜¯ä¸€ä¸ªå­—ç¬¦å‹çš„å‘é‡ã€‚   </li>
<li>å› ä¸ºè®¡ç®—ç´¢å¼•éå¸¸å¿«ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨setindex()ã€‚é™¤éä½ éœ€è¦å¯¹æŸä¸€åˆ—é‡å¤åœ°è¿›è¡Œsubsetæ“ä½œã€‚   </li>
</ul>
<h4 id="b-å‚æ•°jé‡Œçš„select"><a href="#b-å‚æ•°jé‡Œçš„select" class="headerlink" title="b) å‚æ•°jé‡Œçš„select"></a>b) å‚æ•°jé‡Œçš„select</h4><p>ä¸‹é¢æˆ‘ä»¬å°†è¦è®¨è®ºçš„æ‰€æœ‰æ“ä½œï¼Œè·Ÿæˆ‘ä»¬åœ¨ä¸Šä¸€è®²é‡Œé¢å­¦ä¹ çš„ç±»ä¼¼ã€‚åªæ˜¯æˆ‘ä»¬ç°åœ¨ä½¿ç”¨å‚æ•°onã€‚<br>ï¼è¿”å›æ»¡è¶³æ¡ä»¶ origin = â€œLGAâ€ and dest = â€œTPAâ€çš„ arr_delayåˆ—çš„å€¼</p>
<pre><code>flights[.(&quot;LGA&quot;, &quot;TPA&quot;), .(arr_delay), on = c(&quot;origin&quot;, &quot;dest&quot;)]
#       arr_delay
#    1:         1
#    2:        14
#    3:       -17
#    4:        -4
#    5:       -12
#   ---          
# 1848:        39
# 1849:       -24
# 1850:       -12
# 1851:        21
# 1852:       -11
</code></pre><h4 id="c-Chaining"><a href="#c-Chaining" class="headerlink" title="c) Chaining"></a>c) Chaining</h4><p>ï¼åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨chainingæ¥å°†ç»“æœé™åºæ’åˆ—</p>
<pre><code>flights[.(&quot;LGA&quot;, &quot;TPA&quot;), .(arr_delay), on = c(&quot;origin&quot;, &quot;dest&quot;)][order(-arr_delay)]
#       arr_delay
#    1:       486
#    2:       380
#    3:       351
#    4:       318
#    5:       300
#   ---          
# 1848:       -40
# 1849:       -43
# 1850:       -46
# 1851:       -48
# 1852:       -49
</code></pre><h4 id="d-å‚æ•°jé‡Œçš„è®¡ç®—"><a href="#d-å‚æ•°jé‡Œçš„è®¡ç®—" class="headerlink" title="d) å‚æ•°jé‡Œçš„è®¡ç®—"></a>d) å‚æ•°jé‡Œçš„è®¡ç®—</h4><p>ï¼æ‰¾å‡ºæ»¡è¶³æ¡ä»¶ origin = â€œLGAâ€ and dest = â€œTPAâ€çš„ arr_delayåˆ—çš„æœ€å¤§å€¼ï¼ˆèˆªç­åˆ°è¾¾çš„æœ€é•¿å»¶è¯¯æ—¶é—´ï¼‰</p>
<pre><code>flights[.(&quot;LGA&quot;, &quot;TPA&quot;), max(arr_delay), on = c(&quot;origin&quot;, &quot;dest&quot;)]
# [1] 486
</code></pre><h4 id="e-å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦â€-â€è¿›è¡Œsub-assign"><a href="#e-å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦â€-â€è¿›è¡Œsub-assign" class="headerlink" title="e) å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦â€:=â€è¿›è¡Œsub-assign"></a>e) å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦â€:=â€è¿›è¡Œsub-assign</h4><p>åœ¨ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ è¿‡äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚åŒæ ·åœ°ï¼Œç°åœ¨æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æ‰¾åˆ°åœ¨flightsé‡Œé¢ï¼Œhoursåˆ—æ‰€æœ‰å¯èƒ½çš„å–å€¼ï¼š   </p>
<pre><code># get all &apos;hours&apos; in flights
flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸€å…±æœ‰25ç§ä¸åŒçš„å–å€¼ã€‚ä½†æ˜¯0ç‚¹å’Œ24ç‚¹å…¶å®æ˜¯åŒæ ·çš„ã€‚ä¸‹é¢æˆ‘ä»¬æŠŠ24å…¨éƒ¨æ›¿æ¢æˆ0ï¼Œä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨å‚æ•°onã€‚   </p>
<pre><code>flights[.(24L), hour := 0L, on = &quot;hour&quot;]
</code></pre><p>ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹24æ˜¯ä¸æ˜¯éƒ½è¢«æ›¿æ¢æˆ0äº†ï¼š   </p>
<pre><code>flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>è¿™çœŸæ˜¯äºŒçº§ç´¢å¼•çš„ä¸€å¤§ä¼˜ç‚¹ã€‚ä»¥å‰ï¼Œåªæ˜¯ä¸ºäº†æ›´æ–°ä¸€äº›è¡Œçš„houråˆ—çš„å–å€¼ï¼Œæˆ‘ä»¬ä¸å¾—ä¸è°ƒç”¨å‡½æ•°setkey()å°†houråˆ—è®¾ç½®ä¸ºä¸»é”®ï¼Œè¿™å¿…é¡»å¯¹æ•´ä¸ªdata.tableè¿›è¡Œé‡æ–°æ’åºã€‚ä½†æ˜¯ç°åœ¨ï¼Œç”¨å‚æ•°onï¼ŒåŸæ•°æ®çš„é¡ºåºå¹¶æ²¡æœ‰æ”¹å˜ï¼Œæ“ä½œåè€Œæ›´å¿«äº†ï¼è€Œä»£ç è¿˜æ˜¯å¦‚æ­¤ç®€æ´ã€‚   </li>
</ul>
<h4 id="f-é€šè¿‡å‚æ•°byèšåˆ"><a href="#f-é€šè¿‡å‚æ•°byèšåˆ" class="headerlink" title="f) é€šè¿‡å‚æ•°byèšåˆ"></a>f) é€šè¿‡å‚æ•°byèšåˆ</h4><p>ï¼æ‰¾åˆ°æ¯æœˆä»â€œJFKâ€èµ·é£çš„èˆªç­èµ·é£çš„æœ€é•¿å»¶è¯¯æ—¶é—´ï¼Œå¹¶æŒ‰ç…§æœˆä»½æ’åº</p>
<pre><code>ans &lt;- flights[&quot;JFK&quot;, max(dep_delay), keyby = month, on = &quot;origin&quot;]
head(ans)
#    month   V1
# 1:     1  881
# 2:     2 1014
# 3:     3  920
# 4:     4 1241
# 5:     5  853
# 6:     6  798
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨äºŒçº§ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯ä¸åœ¨å‚æ•°oné‡Œé¢æŒ‡å®šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¿…é¡»æŠŠoriginè®¾ç½®ä¸ºä¸»é”®ã€‚   </li>
</ul>
<h4 id="g-å‚æ•°mult"><a href="#g-å‚æ•°mult" class="headerlink" title="g) å‚æ•°mult"></a>g) å‚æ•°mult</h4><p>å‚æ•°multå’Œä¸Šä¸€è®²ä¸€æ ·ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯â€œallâ€ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜¯ç¬¬ä¸€æ¡è¿˜æ˜¯æœ€åä¸€æ¡ç¬¦åˆæ¡ä»¶çš„è¡Œè¢«è¿”å›ã€‚<br>ï¼subsetæ»¡è¶³æ¡ä»¶dest ï¼ â€œBOSâ€ å’Œ â€œDAYâ€çš„ç¬¬ä¸€è¡Œ   </p>
<pre><code>flights[c(&quot;BOS&quot;, &quot;DAY&quot;), on = &quot;dest&quot;, mult = &quot;first&quot;]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1         3         1      AA    JFK  BOS       39      187   12
# 2: 2014     1   1        25        35      EV    EWR  DAY      102      533   17
</code></pre><p>ï¼subsetæ»¡è¶³æ¡ä»¶ origin ï¼ â€œLGAâ€ æˆ–è€… â€œJFKâ€ æˆ–è€… â€œEWRâ€ï¼Œå¹¶ä¸” dest ï¼ â€œXNAâ€ çš„æœ€åä¸€è¡Œ   </p>
<pre><code>flights[.(c(&quot;LGA&quot;, &quot;JFK&quot;, &quot;EWR&quot;), &quot;XNA&quot;), on = c(&quot;origin&quot;, &quot;dest&quot;), mult = &quot;last&quot;]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014    10  31        -5       -11      MQ    LGA  XNA      165     1147    6
# 2:   NA    NA  NA        NA        NA      NA    JFK  XNA       NA       NA   NA
# 3: 2014    10  31        -2       -25      EV    EWR  XNA      160     1131    6
</code></pre><h4 id="h-å‚æ•°nomatch"><a href="#h-å‚æ•°nomatch" class="headerlink" title="h) å‚æ•°nomatch"></a>h) å‚æ•°nomatch</h4><p>å¦‚æœæŸ¥è¯¢è¯­å¥æ²¡æœ‰æ‰¾åˆ°ä»»ä½•åŒ¹é…çš„æ•°æ®ï¼Œé€šè¿‡æŒ‡å®šå‚æ•°nomatchï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜¯è¿”å› NAï¼Œè¿˜æ˜¯å¿½ç•¥ã€‚<br>ï¼åœ¨ä¸Šé¢è¿™ä¸ªåˆ—å­ä¸­ï¼Œå¿½ç•¥æ²¡æœ‰å®é™…æ„ä¹‰çš„æ•°æ®   </p>
<pre><code>flights[.(c(&quot;LGA&quot;, &quot;JFK&quot;, &quot;EWR&quot;), &quot;XNA&quot;), mult = &quot;last&quot;, on = c(&quot;origin&quot;, &quot;dest&quot;), nomatch = 0L]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014    10  31        -5       -11      MQ    LGA  XNA      165     1147    6
# 2: 2014    10  31        -2       -25      EV    EWR  XNA      160     1131    6
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>æ²¡æœ‰èˆªç­ä»â€œJFKâ€èµ·é£åˆ°è¾¾â€œXNAâ€ï¼Œæ‰€ä»¥ç»“æœé‡Œé¢ï¼Œè¿™ä¸€è¡Œè¢«å¿½ç•¥äº†ã€‚   </li>
</ul>
<h2 id="3-è‡ªåŠ¨ç´¢å¼•"><a href="#3-è‡ªåŠ¨ç´¢å¼•" class="headerlink" title="3.è‡ªåŠ¨ç´¢å¼•"></a>3.è‡ªåŠ¨ç´¢å¼•</h2><p>å›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬å…ˆå­¦ä¹ å¦‚ä½•é€šè¿‡ä¸»é”®ä½¿ç”¨å¿«é€ŸäºŒåˆ†æ³•æœç´¢è¿›è¡Œsubsetã€‚æ¥ç€ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨äºŒçº§ç´¢å¼•ï¼Œå®ƒå¸¦æ¥æ›´å¥½çš„æ•ˆæœï¼Œè€Œä¸”è¯­æ³•ä¹Ÿæ›´ç®€æ´ã€‚<br>ç­‰ç­‰ï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Ÿæœ‰ï¼ä¼˜åŒ–Rçš„åŸç”Ÿè¯­æ³•ï¼Œä½¿ç”¨å†…ç½®çš„ç´¢å¼•ã€‚è¿™æ ·æˆ‘ä»¬æ¯‹éœ€ä½¿ç”¨æ–°çš„è¯­æ³•ï¼Œå°±èƒ½å¾—åˆ°åŒæ ·çš„æ•ˆæœã€‚<br>è¿™å°±æ˜¯è‡ªåŠ¨ç´¢å¼•ã€‚<br>ç›®å‰ï¼Œå®ƒåªæ”¯æŒæ“ä½œç¬¦ == å’Œ %in% ã€‚è€Œä¸”åªå¯¹ä¸€åˆ—èµ·ä½œç”¨ã€‚æŸä¸€åˆ—ä¼šè¢«è‡ªåŠ¨åˆ›å»ºä¸ºç´¢å¼•ï¼Œå¹¶ä¸”ä½œä¸ºdata.tableçš„å±æ€§ä¿å­˜èµ·æ¥ã€‚è¿™è·Ÿå‚æ•°onä¸åŒï¼Œå‚æ•°onä¼šæ¯æ¬¡åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç´¢å¼•ï¼Œæ‰€ä»¥æ‰ä¼šè¢«å«åšâ€œäºŒçº§ç´¢å¼•â€ã€‚   </p>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæå¤§çš„data.tableæ¥å‡¸æ˜¾å®ƒçš„ä¼˜åŠ¿ã€‚  </p>
<pre><code>set.seed(1L)
dt = data.table(x = sample(1e5L, 1e7L, TRUE), y = runif(100L))
print(object.size(dt), units = &quot;Mb&quot;)
# 114.4 Mb
</code></pre><p>å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡å¯¹æŸä¸€åˆ—ä½¿ç”¨ == æˆ–è€… %in% çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªäºŒçº§ç´¢å¼•ï¼Œå®ƒä¼šè¢«ç”¨æ¥è¿›è¡Œsubsetã€‚</p>
<pre><code># have a look at all the attribute names
names(attributes(dt))
# [1] &quot;names&quot;             &quot;row.names&quot;         &quot;class&quot;             &quot;.internal.selfref&quot;

## run thefirst time
(t1 &lt;- system.time(ans &lt;- dt[x == 989L]))
#    user  system elapsed 
#   0.235   0.013   0.249
head(ans)
#      x         y
# 1: 989 0.5372007
# 2: 989 0.5642786
# 3: 989 0.7151100
# 4: 989 0.3920405
# 5: 989 0.9547465
# 6: 989 0.2914710

## secondary index is created
names(attributes(dt))
# [1] &quot;names&quot;             &quot;row.names&quot;         &quot;class&quot;             &quot;.internal.selfref&quot;
# [5] &quot;index&quot;

indices(dt)
# [1] &quot;x&quot;
</code></pre><p>ç¬¬ä¸€æ¬¡subsetçš„æ—¶å€™ï¼Œå°±æ˜¯åˆ›å»ºç´¢å¼•çš„æ—¶å€™ã€‚å› ä¸ºåˆ›å»ºäºŒçº§ç´¢å¼•åªä¼šå¼•å…¥ä¸€ä¸ªæ’åºå‘é‡ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™ç§æ“ä½œç¬¦çš„æ–¹å¼ä¼šæ¯”æ‰«æå‘é‡å¿«å¾—å¤šã€‚æ‰€ä»¥ï¼Œä»ç¬¬äºŒæ¬¡subsetå¼€å§‹ï¼Œè‡ªåŠ¨ç´¢å¼•çš„ä¼˜åŠ¿å°±éå¸¸æ˜æ˜¾äº†ï¼š</p>
<pre><code>## successive subsets
(t2 &lt;- system.time(dt[x == 989L]))
#    user  system elapsed 
#   0.001   0.000   0.001
system.time(dt[x %in% 1989:2012])
#    user  system elapsed 
#   0.001   0.000   0.001
</code></pre><p>è¯´æ˜ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ¬¡subsetèŠ±äº†0.228ç§’ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡åªèŠ±äº†0.001ç§’ï¼   </li>
<li>å¯ä»¥é€šè¿‡è®¾ç½®å…¨å±€å‚æ•°å…³é—­è‡ªåŠ¨ç´¢å¼•ï¼šoptions(datatable.auto.index = FALSE)ã€‚   </li>
</ul>
<p>æˆ‘ä»¬æ­£åœ¨å°†äºŒåˆ†æ³•æœç´¢æ‰©å±•åˆ°å…¶å®ƒçš„æ“ä½œç¬¦ï¼Œæ¯”å¦‚ &lt;, &lt;= å’Œ &gt;=ã€‚å®Œæˆä¹‹åï¼Œå°±èƒ½ç›´æ¥ç”¨åœ¨å…¶ä»–æ“ä½œç¬¦ä¸Šäº†ã€‚<br>åœ¨å°†æ¥ï¼Œæˆ‘ä»¬è®¡åˆ’å°†è‡ªåŠ¨ç´¢å¼•æ‰©å±•åˆ°å‚æ•°ä¸­çš„å…¶å®ƒåˆ—ã€‚   </p>
<p>åœ¨ä¸‹ä¸€è®²â€œç»“åˆå’Œæ»šåŠ¨ç»“åˆâ€ä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ ä½¿ç”¨ä¸»é”®å’ŒäºŒçº§ç´¢å¼•è¿›è¡Œå¿«é€Ÿsubsetã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://youngspring1.github.io/2016/2016-04-02-datatable4/" data-id="cjg0qm5n40037yyw8yiz00tgu" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/data-table/">data.table</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/6/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">CategorieÃ«n</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/data-tableæ•™ç¨‹/">data.tableæ•™ç¨‹</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ•°æ®åˆ†æç¬”è®°/">æ•°æ®åˆ†æç¬”è®°</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ–°çŸ¥/">æ–°çŸ¥</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/æœºå™¨å­¦ä¹ çš„æ•°å­¦åŸºç¡€/">æœºå™¨å­¦ä¹ çš„æ•°å­¦åŸºç¡€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ç”Ÿæ´»/">ç”Ÿæ´»</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/è¯»ä¹¦/">è¯»ä¹¦</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Labels</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Excel/">Excel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kevin-Kelly/">Kevin Kelly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LCS/">LCS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSS-Lisence/">OSS Lisence</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/R/">R</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/The-Inevitable/">The Inevitable</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/career/">career</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/class/">class</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-table/">data.table</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/evalution/">evalution</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github-pages-blog/">github pages blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hugo/">hugo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/joel-on-software/">joel on software</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mode/">mode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shiny-server/">shiny server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/software/">software</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typeof/">typeof</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/west-world/">west world</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xlrd/">xlrd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ä¸“æ³¨/">ä¸“æ³¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/äººç±»ç®€å²/">äººç±»ç®€å²</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å…¥é—¨æ•™ç¨‹/">å…¥é—¨æ•™ç¨‹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å•è½¦/">å•è½¦</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å†å²/">å†å²</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å¡å°”è¾¾ä¼ è¯´/">å¡å°”è¾¾ä¼ è¯´</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å­”åº™å­”åºœå­”æ—/">å­”åº™å­”åºœå­”æ—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å°è¯´/">å°è¯´</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å½’ä¸€åŒ–/">å½’ä¸€åŒ–</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æƒ³æ³•/">æƒ³æ³•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ„Ÿå—/">æ„Ÿå—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ•¦ç…Œ/">æ•¦ç…Œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ•°æ®åˆ†æ/">æ•°æ®åˆ†æ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ—…è¡Œ/">æ—…è¡Œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ—¥æœ¬/">æ—¥æœ¬</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æœ‰é¡¶å¤©å®¶æ—/">æœ‰é¡¶å¤©å®¶æ—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æœºå™¨å­¦ä¹ /">æœºå™¨å­¦ä¹ </a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ¦‚ç‡/">æ¦‚ç‡</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ³°å±±/">æ³°å±±</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ´›é˜³/">æ´›é˜³</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ¸¸æˆ/">æ¸¸æˆ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/çŒ«/">çŒ«</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç”Ÿæ´»æ„Ÿå—/">ç”Ÿæ´»æ„Ÿå—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç”µå½±/">ç”µå½±</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç¢ç¢å¿µ/">ç¢ç¢å¿µ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç©¿è¶Š/">ç©¿è¶Š</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç®€å•å·¥ä½œ/">ç®€å•å·¥ä½œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç®—æ³•/">ç®—æ³•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç¾é£Ÿ/">ç¾é£Ÿ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/èƒŒæ™¯çŸ¥è¯†/">èƒŒæ™¯çŸ¥è¯†</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è¥¿å®‰/">è¥¿å®‰</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è¯—/">è¯—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è¯­éŸ³è¯†åˆ«/">è¯­éŸ³è¯†åˆ«</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è¯»ä¹¦/">è¯»ä¹¦</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/èµ›è½¦/">èµ›è½¦</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Excel/" style="font-size: 10px;">Excel</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Kevin-Kelly/" style="font-size: 10px;">Kevin Kelly</a> <a href="/tags/LCS/" style="font-size: 10px;">LCS</a> <a href="/tags/OSS-Lisence/" style="font-size: 10px;">OSS Lisence</a> <a href="/tags/R/" style="font-size: 20px;">R</a> <a href="/tags/The-Inevitable/" style="font-size: 10px;">The Inevitable</a> <a href="/tags/career/" style="font-size: 10px;">career</a> <a href="/tags/class/" style="font-size: 10px;">class</a> <a href="/tags/data-table/" style="font-size: 17.5px;">data.table</a> <a href="/tags/design/" style="font-size: 10px;">design</a> <a href="/tags/evalution/" style="font-size: 10px;">evalution</a> <a href="/tags/github-pages-blog/" style="font-size: 10px;">github pages blog</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/hugo/" style="font-size: 10px;">hugo</a> <a href="/tags/joel-on-software/" style="font-size: 10px;">joel on software</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/mode/" style="font-size: 10px;">mode</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/shiny-server/" style="font-size: 12.5px;">shiny server</a> <a href="/tags/software/" style="font-size: 12.5px;">software</a> <a href="/tags/typeof/" style="font-size: 10px;">typeof</a> <a href="/tags/west-world/" style="font-size: 10px;">west world</a> <a href="/tags/xlrd/" style="font-size: 10px;">xlrd</a> <a href="/tags/ä¸“æ³¨/" style="font-size: 10px;">ä¸“æ³¨</a> <a href="/tags/äººç±»ç®€å²/" style="font-size: 10px;">äººç±»ç®€å²</a> <a href="/tags/å…¥é—¨æ•™ç¨‹/" style="font-size: 10px;">å…¥é—¨æ•™ç¨‹</a> <a href="/tags/å•è½¦/" style="font-size: 10px;">å•è½¦</a> <a href="/tags/å†å²/" style="font-size: 10px;">å†å²</a> <a href="/tags/å¡å°”è¾¾ä¼ è¯´/" style="font-size: 10px;">å¡å°”è¾¾ä¼ è¯´</a> <a href="/tags/å­”åº™å­”åºœå­”æ—/" style="font-size: 10px;">å­”åº™å­”åºœå­”æ—</a> <a href="/tags/å°è¯´/" style="font-size: 10px;">å°è¯´</a> <a href="/tags/å½’ä¸€åŒ–/" style="font-size: 10px;">å½’ä¸€åŒ–</a> <a href="/tags/æƒ³æ³•/" style="font-size: 12.5px;">æƒ³æ³•</a> <a href="/tags/æ„Ÿå—/" style="font-size: 10px;">æ„Ÿå—</a> <a href="/tags/æ•¦ç…Œ/" style="font-size: 10px;">æ•¦ç…Œ</a> <a href="/tags/æ•°æ®åˆ†æ/" style="font-size: 10px;">æ•°æ®åˆ†æ</a> <a href="/tags/æ—…è¡Œ/" style="font-size: 17.5px;">æ—…è¡Œ</a> <a href="/tags/æ—¥æœ¬/" style="font-size: 15px;">æ—¥æœ¬</a> <a href="/tags/æœ‰é¡¶å¤©å®¶æ—/" style="font-size: 10px;">æœ‰é¡¶å¤©å®¶æ—</a> <a href="/tags/æœºå™¨å­¦ä¹ /" style="font-size: 10px;">æœºå™¨å­¦ä¹ </a> <a href="/tags/æ¦‚ç‡/" style="font-size: 12.5px;">æ¦‚ç‡</a> <a href="/tags/æ³°å±±/" style="font-size: 10px;">æ³°å±±</a> <a href="/tags/æ´›é˜³/" style="font-size: 10px;">æ´›é˜³</a> <a href="/tags/æ·±åº¦å­¦ä¹ /" style="font-size: 10px;">æ·±åº¦å­¦ä¹ </a> <a href="/tags/æ¸¸æˆ/" style="font-size: 12.5px;">æ¸¸æˆ</a> <a href="/tags/çŒ«/" style="font-size: 10px;">çŒ«</a> <a href="/tags/ç”Ÿæ´»æ„Ÿå—/" style="font-size: 10px;">ç”Ÿæ´»æ„Ÿå—</a> <a href="/tags/ç”µå½±/" style="font-size: 10px;">ç”µå½±</a> <a href="/tags/ç¢ç¢å¿µ/" style="font-size: 10px;">ç¢ç¢å¿µ</a> <a href="/tags/ç©¿è¶Š/" style="font-size: 10px;">ç©¿è¶Š</a> <a href="/tags/ç®€å•å·¥ä½œ/" style="font-size: 10px;">ç®€å•å·¥ä½œ</a> <a href="/tags/ç®—æ³•/" style="font-size: 10px;">ç®—æ³•</a> <a href="/tags/ç¾é£Ÿ/" style="font-size: 10px;">ç¾é£Ÿ</a> <a href="/tags/èƒŒæ™¯çŸ¥è¯†/" style="font-size: 10px;">èƒŒæ™¯çŸ¥è¯†</a> <a href="/tags/è¥¿å®‰/" style="font-size: 10px;">è¥¿å®‰</a> <a href="/tags/è¯—/" style="font-size: 10px;">è¯—</a> <a href="/tags/è¯­éŸ³è¯†åˆ«/" style="font-size: 10px;">è¯­éŸ³è¯†åˆ«</a> <a href="/tags/è¯»ä¹¦/" style="font-size: 10px;">è¯»ä¹¦</a> <a href="/tags/èµ›è½¦/" style="font-size: 10px;">èµ›è½¦</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archieven</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recente berichten</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/2018-04-15-tour-de-hyrule/">æµ·æ‹‰é²å¤§é™†æ—…è¡ŒæŒ‡å—</a>
          </li>
        
          <li>
            <a href="/2017/2017-10-20-parse-date-in-xlsx/">ç”¨ Python è§£æ Excel å‘ç°çš„å°å‘</a>
          </li>
        
          <li>
            <a href="/2017/2017-10-15-hexo/">è¿ç§»åšå®¢ç³»ç»Ÿåˆ°hexo</a>
          </li>
        
          <li>
            <a href="/2017/2017-07-02-food/">è¿·ä¸Šåšé¥­è§†é¢‘</a>
          </li>
        
          <li>
            <a href="/2017/2017-06-25-jizhi/">é›†æ™ºç½‘æ–‡ç« ç´¢å¼•</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 youngspring1<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>